"0",""
"0","data_subset$time_30min<-str_replace_all(data_subset$time_30min,""2014-01-23 21:30:00"",""2014-01-23 21:00:00"")"
"0",""
"0","bigrams <- data_subset%>%"
"0","  group_by(time_30min)%>%"
"0","  unnest_tokens(word, "
"0","                cleaned, "
"0","                token = ""ngrams"", "
"0","                n = 2) %>%"
"0","  count(time_30min,word, sort = TRUE) %>% ungroup()"
"0",""
"0",""
"0","tf_idf <- bigrams%>%"
"0","  bind_tf_idf(word,time_30min, n) %>%"
"0","  arrange(desc(tf_idf))"
"0",""
"0","tf_idf$time_30min<-str_replace_all(tf_idf $time_30min,""2014-01-23 "","""")"
"0",""
"0","l1<-c(""18:30:00"",""19:30:00"",""17:00:00"",""19:00:00"",""20:00:00"",""20:30:00"",""18:00:00"",""17:30:00"",""21:00:00"",""21:30:00"")"
"0","Time_30min<-c(""18:30-19:00"",""19:30-20:00"",""17:00-17:30"",""19:00-19:30"",""20:00-20:30"",""20:30-21:00"",""18:00-18:30"",""17:30-18:00"",""21:00-21:31"",""21:00-21:31"")"
"0","time_30min_df<-data.frame(l1,Time_30min)"
"0",""
"0","tf_idf<-left_join(tf_idf,time_30min_df,by=c(""time_30min""=""l1""))"
"0",""
"0",""
"0",""
"0","tf_idf %>%"
"0","  group_by(Time_30min) %>%"
"0","  slice_max(tf_idf,"
"0","            n = 10) %>%"
"0","  ungroup() %>%"
"0","  mutate(word = reorder(word,"
"0","                        tf_idf)) %>%"
"0","  ggplot(aes(tf_idf,"
"0","             word,"
"0","             fill = Time_30min)) +"
"0","  geom_col(show.legend = FALSE) +"
"0","  facet_wrap(~ Time_30min,"
"0","             scales = ""free"") +"
"0","  labs(x = ""TF-IDF Bigram in 30 time interval"","
"0","       y = NULL)"
