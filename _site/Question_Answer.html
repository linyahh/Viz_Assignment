<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">

<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1"/>
  <meta name="generator" content="distill" />

  <style type="text/css">
  /* Hide doc at startup (prevent jankiness while JS renders/transforms) */
  body {
    visibility: hidden;
  }
  </style>

 <!--radix_placeholder_import_source-->
 <!--/radix_placeholder_import_source-->

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ad0000; } /* Alert */
code span.an { color: #5e5e5e; } /* Annotation */
code span.at { color: #20794d; } /* Attribute */
code span.bn { color: #ad0000; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007ba5; } /* ControlFlow */
code span.ch { color: #20794d; } /* Char */
code span.cn { color: #8f5902; } /* Constant */
code span.co { color: #5e5e5e; } /* Comment */
code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
code span.dt { color: #ad0000; } /* DataType */
code span.dv { color: #ad0000; } /* DecVal */
code span.er { color: #ad0000; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #ad0000; } /* Float */
code span.fu { color: #4758ab; } /* Function */
code span.im { } /* Import */
code span.in { color: #5e5e5e; } /* Information */
code span.kw { color: #007ba5; } /* Keyword */
code span.op { color: #5e5e5e; } /* Operator */
code span.ot { color: #007ba5; } /* Other */
code span.pp { color: #ad0000; } /* Preprocessor */
code span.sc { color: #20794d; } /* SpecialChar */
code span.ss { color: #20794d; } /* SpecialString */
code span.st { color: #20794d; } /* String */
code span.va { color: #111111; } /* Variable */
code span.vs { color: #20794d; } /* VerbatimString */
code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
</style>

  <!--radix_placeholder_meta_tags-->
  <title>Linya Huang: Question Answer</title>
  
  <meta property="description" itemprop="description" content="Use visual analytics to analyze the available data and evaluate the changing levels of risk to the public and recommend actions."/>
  
  
  <!--  https://schema.org/Article -->
  <meta property="article:published" itemprop="datePublished" content="2021-07-25"/>
  <meta property="article:created" itemprop="dateCreated" content="2021-07-25"/>
  <meta name="article:author" content="Linya Huang"/>
  <meta name="article:author" content=""/>
  
  <!--  https://developers.facebook.com/docs/sharing/webmasters#markup -->
  <meta property="og:title" content="Linya Huang: Question Answer"/>
  <meta property="og:type" content="article"/>
  <meta property="og:description" content="Use visual analytics to analyze the available data and evaluate the changing levels of risk to the public and recommend actions."/>
  <meta property="og:locale" content="en_US"/>
  <meta property="og:site_name" content="Linya Huang"/>
  
  <!--  https://dev.twitter.com/cards/types/summary -->
  <meta property="twitter:card" content="summary"/>
  <meta property="twitter:title" content="Linya Huang: Question Answer"/>
  <meta property="twitter:description" content="Use visual analytics to analyze the available data and evaluate the changing levels of risk to the public and recommend actions."/>
  
  <!--/radix_placeholder_meta_tags-->
  <!--radix_placeholder_rmarkdown_metadata-->
  
  <script type="text/json" id="radix-rmarkdown-metadata">
  {"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["title","description","author","date","output"]}},"value":[{"type":"character","attributes":{},"value":["Question Answer"]},{"type":"character","attributes":{},"value":["Use visual analytics to analyze the available data and evaluate the changing levels of risk to the public and recommend actions.\n"]},{"type":"list","attributes":{},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name"]}},"value":[{"type":"character","attributes":{},"value":["Linya Huang"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["affiliation"]}},"value":[{"type":"character","attributes":{},"value":["School of Computing and Information Systems, Singapore Management University"]}]}]},{"type":"character","attributes":{},"value":["07-25-2021"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["distill::distill_article"]}},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["code_folding","toc","toc_depth","self_contained"]}},"value":[{"type":"logical","attributes":{},"value":[true]},{"type":"logical","attributes":{},"value":[true]},{"type":"integer","attributes":{},"value":[6]},{"type":"logical","attributes":{},"value":[false]}]}]}]}
  </script>
  <!--/radix_placeholder_rmarkdown_metadata-->
  <!--radix_placeholder_navigation_in_header-->
  <meta name="distill:offset" content=""/>
  
  <script type="application/javascript">
  
    window.headroom_prevent_pin = false;
  
    window.document.addEventListener("DOMContentLoaded", function (event) {
  
      // initialize headroom for banner
      var header = $('header').get(0);
      var headerHeight = header.offsetHeight;
      var headroom = new Headroom(header, {
        tolerance: 5,
        onPin : function() {
          if (window.headroom_prevent_pin) {
            window.headroom_prevent_pin = false;
            headroom.unpin();
          }
        }
      });
      headroom.init();
      if(window.location.hash)
        headroom.unpin();
      $(header).addClass('headroom--transition');
  
      // offset scroll location for banner on hash change
      // (see: https://github.com/WickyNilliams/headroom.js/issues/38)
      window.addEventListener("hashchange", function(event) {
        window.scrollTo(0, window.pageYOffset - (headerHeight + 25));
      });
  
      // responsive menu
      $('.distill-site-header').each(function(i, val) {
        var topnav = $(this);
        var toggle = topnav.find('.nav-toggle');
        toggle.on('click', function() {
          topnav.toggleClass('responsive');
        });
      });
  
      // nav dropdowns
      $('.nav-dropbtn').click(function(e) {
        $(this).next('.nav-dropdown-content').toggleClass('nav-dropdown-active');
        $(this).parent().siblings('.nav-dropdown')
           .children('.nav-dropdown-content').removeClass('nav-dropdown-active');
      });
      $("body").click(function(e){
        $('.nav-dropdown-content').removeClass('nav-dropdown-active');
      });
      $(".nav-dropdown").click(function(e){
        e.stopPropagation();
      });
    });
  </script>
  
  <style type="text/css">
  
  /* Theme (user-documented overrideables for nav appearance) */
  
  .distill-site-nav {
    color: rgba(255, 255, 255, 0.8);
    background-color: #0F2E3D;
    font-size: 15px;
    font-weight: 300;
  }
  
  .distill-site-nav a {
    color: inherit;
    text-decoration: none;
  }
  
  .distill-site-nav a:hover {
    color: white;
  }
  
  @media print {
    .distill-site-nav {
      display: none;
    }
  }
  
  .distill-site-header {
  
  }
  
  .distill-site-footer {
  
  }
  
  
  /* Site Header */
  
  .distill-site-header {
    width: 100%;
    box-sizing: border-box;
    z-index: 3;
  }
  
  .distill-site-header .nav-left {
    display: inline-block;
    margin-left: 8px;
  }
  
  @media screen and (max-width: 768px) {
    .distill-site-header .nav-left {
      margin-left: 0;
    }
  }
  
  
  .distill-site-header .nav-right {
    float: right;
    margin-right: 8px;
  }
  
  .distill-site-header a,
  .distill-site-header .title {
    display: inline-block;
    text-align: center;
    padding: 14px 10px 14px 10px;
  }
  
  .distill-site-header .title {
    font-size: 18px;
    min-width: 150px;
  }
  
  .distill-site-header .logo {
    padding: 0;
  }
  
  .distill-site-header .logo img {
    display: none;
    max-height: 20px;
    width: auto;
    margin-bottom: -4px;
  }
  
  .distill-site-header .nav-image img {
    max-height: 18px;
    width: auto;
    display: inline-block;
    margin-bottom: -3px;
  }
  
  
  
  @media screen and (min-width: 1000px) {
    .distill-site-header .logo img {
      display: inline-block;
    }
    .distill-site-header .nav-left {
      margin-left: 20px;
    }
    .distill-site-header .nav-right {
      margin-right: 20px;
    }
    .distill-site-header .title {
      padding-left: 12px;
    }
  }
  
  
  .distill-site-header .nav-toggle {
    display: none;
  }
  
  .nav-dropdown {
    display: inline-block;
    position: relative;
  }
  
  .nav-dropdown .nav-dropbtn {
    border: none;
    outline: none;
    color: rgba(255, 255, 255, 0.8);
    padding: 16px 10px;
    background-color: transparent;
    font-family: inherit;
    font-size: inherit;
    font-weight: inherit;
    margin: 0;
    margin-top: 1px;
    z-index: 2;
  }
  
  .nav-dropdown-content {
    display: none;
    position: absolute;
    background-color: white;
    min-width: 200px;
    border: 1px solid rgba(0,0,0,0.15);
    border-radius: 4px;
    box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.1);
    z-index: 1;
    margin-top: 2px;
    white-space: nowrap;
    padding-top: 4px;
    padding-bottom: 4px;
  }
  
  .nav-dropdown-content hr {
    margin-top: 4px;
    margin-bottom: 4px;
    border: none;
    border-bottom: 1px solid rgba(0, 0, 0, 0.1);
  }
  
  .nav-dropdown-active {
    display: block;
  }
  
  .nav-dropdown-content a, .nav-dropdown-content .nav-dropdown-header {
    color: black;
    padding: 6px 24px;
    text-decoration: none;
    display: block;
    text-align: left;
  }
  
  .nav-dropdown-content .nav-dropdown-header {
    display: block;
    padding: 5px 24px;
    padding-bottom: 0;
    text-transform: uppercase;
    font-size: 14px;
    color: #999999;
    white-space: nowrap;
  }
  
  .nav-dropdown:hover .nav-dropbtn {
    color: white;
  }
  
  .nav-dropdown-content a:hover {
    background-color: #ddd;
    color: black;
  }
  
  .nav-right .nav-dropdown-content {
    margin-left: -45%;
    right: 0;
  }
  
  @media screen and (max-width: 768px) {
    .distill-site-header a, .distill-site-header .nav-dropdown  {display: none;}
    .distill-site-header a.nav-toggle {
      float: right;
      display: block;
    }
    .distill-site-header .title {
      margin-left: 0;
    }
    .distill-site-header .nav-right {
      margin-right: 0;
    }
    .distill-site-header {
      overflow: hidden;
    }
    .nav-right .nav-dropdown-content {
      margin-left: 0;
    }
  }
  
  
  @media screen and (max-width: 768px) {
    .distill-site-header.responsive {position: relative; min-height: 500px; }
    .distill-site-header.responsive a.nav-toggle {
      position: absolute;
      right: 0;
      top: 0;
    }
    .distill-site-header.responsive a,
    .distill-site-header.responsive .nav-dropdown {
      display: block;
      text-align: left;
    }
    .distill-site-header.responsive .nav-left,
    .distill-site-header.responsive .nav-right {
      width: 100%;
    }
    .distill-site-header.responsive .nav-dropdown {float: none;}
    .distill-site-header.responsive .nav-dropdown-content {position: relative;}
    .distill-site-header.responsive .nav-dropdown .nav-dropbtn {
      display: block;
      width: 100%;
      text-align: left;
    }
  }
  
  /* Site Footer */
  
  .distill-site-footer {
    width: 100%;
    overflow: hidden;
    box-sizing: border-box;
    z-index: 3;
    margin-top: 30px;
    padding-top: 30px;
    padding-bottom: 30px;
    text-align: center;
  }
  
  /* Headroom */
  
  d-title {
    padding-top: 6rem;
  }
  
  @media print {
    d-title {
      padding-top: 4rem;
    }
  }
  
  .headroom {
    z-index: 1000;
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
  }
  
  .headroom--transition {
    transition: all .4s ease-in-out;
  }
  
  .headroom--unpinned {
    top: -100px;
  }
  
  .headroom--pinned {
    top: 0;
  }
  
  /* adjust viewport for navbar height */
  /* helps vertically center bootstrap (non-distill) content */
  .min-vh-100 {
    min-height: calc(100vh - 100px) !important;
  }
  
  </style>
  
  <script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
  <link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet"/>
  <link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet"/>
  <script src="site_libs/headroom-0.9.4/headroom.min.js"></script>
  <script src="site_libs/autocomplete-0.37.1/autocomplete.min.js"></script>
  <script src="site_libs/fuse-6.4.1/fuse.min.js"></script>
  
  <script type="application/javascript">
  
  function getMeta(metaName) {
    var metas = document.getElementsByTagName('meta');
    for (let i = 0; i < metas.length; i++) {
      if (metas[i].getAttribute('name') === metaName) {
        return metas[i].getAttribute('content');
      }
    }
    return '';
  }
  
  function offsetURL(url) {
    var offset = getMeta('distill:offset');
    return offset ? offset + '/' + url : url;
  }
  
  function createFuseIndex() {
  
    // create fuse index
    var options = {
      keys: [
        { name: 'title', weight: 20 },
        { name: 'categories', weight: 15 },
        { name: 'description', weight: 10 },
        { name: 'contents', weight: 5 },
      ],
      ignoreLocation: true,
      threshold: 0
    };
    var fuse = new window.Fuse([], options);
  
    // fetch the main search.json
    return fetch(offsetURL('search.json'))
      .then(function(response) {
        if (response.status == 200) {
          return response.json().then(function(json) {
            // index main articles
            json.articles.forEach(function(article) {
              fuse.add(article);
            });
            // download collections and index their articles
            return Promise.all(json.collections.map(function(collection) {
              return fetch(offsetURL(collection)).then(function(response) {
                if (response.status === 200) {
                  return response.json().then(function(articles) {
                    articles.forEach(function(article) {
                      fuse.add(article);
                    });
                  })
                } else {
                  return Promise.reject(
                    new Error('Unexpected status from search index request: ' +
                              response.status)
                  );
                }
              });
            })).then(function() {
              return fuse;
            });
          });
  
        } else {
          return Promise.reject(
            new Error('Unexpected status from search index request: ' +
                        response.status)
          );
        }
      });
  }
  
  window.document.addEventListener("DOMContentLoaded", function (event) {
  
    // get search element (bail if we don't have one)
    var searchEl = window.document.getElementById('distill-search');
    if (!searchEl)
      return;
  
    createFuseIndex()
      .then(function(fuse) {
  
        // make search box visible
        searchEl.classList.remove('hidden');
  
        // initialize autocomplete
        var options = {
          autoselect: true,
          hint: false,
          minLength: 2,
        };
        window.autocomplete(searchEl, options, [{
          source: function(query, callback) {
            const searchOptions = {
              isCaseSensitive: false,
              shouldSort: true,
              minMatchCharLength: 2,
              limit: 10,
            };
            var results = fuse.search(query, searchOptions);
            callback(results
              .map(function(result) { return result.item; })
            );
          },
          templates: {
            suggestion: function(suggestion) {
              var img = suggestion.preview && Object.keys(suggestion.preview).length > 0
                ? `<img src="${offsetURL(suggestion.preview)}"</img>`
                : '';
              var html = `
                <div class="search-item">
                  <h3>${suggestion.title}</h3>
                  <div class="search-item-description">
                    ${suggestion.description || ''}
                  </div>
                  <div class="search-item-preview">
                    ${img}
                  </div>
                </div>
              `;
              return html;
            }
          }
        }]).on('autocomplete:selected', function(event, suggestion) {
          window.location.href = offsetURL(suggestion.path);
        });
        // remove inline display style on autocompleter (we want to
        // manage responsive display via css)
        $('.algolia-autocomplete').css("display", "");
      })
      .catch(function(error) {
        console.log(error);
      });
  
  });
  
  </script>
  
  <style type="text/css">
  
  .nav-search {
    font-size: x-small;
  }
  
  /* Algolioa Autocomplete */
  
  .algolia-autocomplete {
    display: inline-block;
    margin-left: 10px;
    vertical-align: sub;
    background-color: white;
    color: black;
    padding: 6px;
    padding-top: 8px;
    padding-bottom: 0;
    border-radius: 6px;
    border: 1px #0F2E3D solid;
    width: 180px;
  }
  
  
  @media screen and (max-width: 768px) {
    .distill-site-nav .algolia-autocomplete {
      display: none;
      visibility: hidden;
    }
    .distill-site-nav.responsive .algolia-autocomplete {
      display: inline-block;
      visibility: visible;
    }
    .distill-site-nav.responsive .algolia-autocomplete .aa-dropdown-menu {
      margin-left: 0;
      width: 400px;
      max-height: 400px;
    }
  }
  
  .algolia-autocomplete .aa-input, .algolia-autocomplete .aa-hint {
    width: 90%;
    outline: none;
    border: none;
  }
  
  .algolia-autocomplete .aa-hint {
    color: #999;
  }
  .algolia-autocomplete .aa-dropdown-menu {
    width: 550px;
    max-height: 70vh;
    overflow-x: visible;
    overflow-y: scroll;
    padding: 5px;
    margin-top: 3px;
    margin-left: -150px;
    background-color: #fff;
    border-radius: 5px;
    border: 1px solid #999;
    border-top: none;
  }
  
  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion {
    cursor: pointer;
    padding: 5px 4px;
    border-bottom: 1px solid #eee;
  }
  
  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion:last-of-type {
    border-bottom: none;
    margin-bottom: 2px;
  }
  
  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item {
    overflow: hidden;
    font-size: 0.8em;
    line-height: 1.4em;
  }
  
  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item h3 {
    font-size: 1rem;
    margin-block-start: 0;
    margin-block-end: 5px;
  }
  
  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-description {
    display: inline-block;
    overflow: hidden;
    height: 2.8em;
    width: 80%;
    margin-right: 4%;
  }
  
  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-preview {
    display: inline-block;
    width: 15%;
  }
  
  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-preview img {
    height: 3em;
    width: auto;
    display: none;
  }
  
  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-preview img[src] {
    display: initial;
  }
  
  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion.aa-cursor {
    background-color: #eee;
  }
  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion em {
    font-weight: bold;
    font-style: normal;
  }
  
  </style>
  
  
  <!--/radix_placeholder_navigation_in_header-->
  <!--radix_placeholder_distill-->
  
  <style type="text/css">
  
  body {
    background-color: white;
  }
  
  .pandoc-table {
    width: 100%;
  }
  
  .pandoc-table>caption {
    margin-bottom: 10px;
  }
  
  .pandoc-table th:not([align]) {
    text-align: left;
  }
  
  .pagedtable-footer {
    font-size: 15px;
  }
  
  d-byline .byline {
    grid-template-columns: 2fr 2fr;
  }
  
  d-byline .byline h3 {
    margin-block-start: 1.5em;
  }
  
  d-byline .byline .authors-affiliations h3 {
    margin-block-start: 0.5em;
  }
  
  .authors-affiliations .orcid-id {
    width: 16px;
    height:16px;
    margin-left: 4px;
    margin-right: 4px;
    vertical-align: middle;
    padding-bottom: 2px;
  }
  
  d-title .dt-tags {
    margin-top: 1em;
    grid-column: text;
  }
  
  .dt-tags .dt-tag {
    text-decoration: none;
    display: inline-block;
    color: rgba(0,0,0,0.6);
    padding: 0em 0.4em;
    margin-right: 0.5em;
    margin-bottom: 0.4em;
    font-size: 70%;
    border: 1px solid rgba(0,0,0,0.2);
    border-radius: 3px;
    text-transform: uppercase;
    font-weight: 500;
  }
  
  d-article table.gt_table td,
  d-article table.gt_table th {
    border-bottom: none;
  }
  
  .html-widget {
    margin-bottom: 2.0em;
  }
  
  .l-screen-inset {
    padding-right: 16px;
  }
  
  .l-screen .caption {
    margin-left: 10px;
  }
  
  .shaded {
    background: rgb(247, 247, 247);
    padding-top: 20px;
    padding-bottom: 20px;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
    border-bottom: 1px solid rgba(0, 0, 0, 0.1);
  }
  
  .shaded .html-widget {
    margin-bottom: 0;
    border: 1px solid rgba(0, 0, 0, 0.1);
  }
  
  .shaded .shaded-content {
    background: white;
  }
  
  .text-output {
    margin-top: 0;
    line-height: 1.5em;
  }
  
  .hidden {
    display: none !important;
  }
  
  d-article {
    padding-top: 2.5rem;
    padding-bottom: 30px;
  }
  
  d-appendix {
    padding-top: 30px;
  }
  
  d-article>p>img {
    width: 100%;
  }
  
  d-article h2 {
    margin: 1rem 0 1.5rem 0;
  }
  
  d-article h3 {
    margin-top: 1.5rem;
  }
  
  d-article iframe {
    border: 1px solid rgba(0, 0, 0, 0.1);
    margin-bottom: 2.0em;
    width: 100%;
  }
  
  /* Tweak code blocks */
  
  d-article div.sourceCode code,
  d-article pre code {
    font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
  }
  
  d-article pre,
  d-article div.sourceCode,
  d-article div.sourceCode pre {
    overflow: auto;
  }
  
  d-article div.sourceCode {
    background-color: white;
  }
  
  d-article div.sourceCode pre {
    padding-left: 10px;
    font-size: 12px;
    border-left: 2px solid rgba(0,0,0,0.1);
  }
  
  d-article pre {
    font-size: 12px;
    color: black;
    background: none;
    margin-top: 0;
    text-align: left;
    white-space: pre;
    word-spacing: normal;
    word-break: normal;
    word-wrap: normal;
    line-height: 1.5;
  
    -moz-tab-size: 4;
    -o-tab-size: 4;
    tab-size: 4;
  
    -webkit-hyphens: none;
    -moz-hyphens: none;
    -ms-hyphens: none;
    hyphens: none;
  }
  
  d-article pre a {
    border-bottom: none;
  }
  
  d-article pre a:hover {
    border-bottom: none;
    text-decoration: underline;
  }
  
  d-article details {
    grid-column: text;
    margin-bottom: 0.8em;
  }
  
  @media(min-width: 768px) {
  
  d-article pre,
  d-article div.sourceCode,
  d-article div.sourceCode pre {
    overflow: visible !important;
  }
  
  d-article div.sourceCode pre {
    padding-left: 18px;
    font-size: 14px;
  }
  
  d-article pre {
    font-size: 14px;
  }
  
  }
  
  figure img.external {
    background: white;
    border: 1px solid rgba(0, 0, 0, 0.1);
    box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
    padding: 18px;
    box-sizing: border-box;
  }
  
  /* CSS for d-contents */
  
  .d-contents {
    grid-column: text;
    color: rgba(0,0,0,0.8);
    font-size: 0.9em;
    padding-bottom: 1em;
    margin-bottom: 1em;
    padding-bottom: 0.5em;
    margin-bottom: 1em;
    padding-left: 0.25em;
    justify-self: start;
  }
  
  @media(min-width: 1000px) {
    .d-contents.d-contents-float {
      height: 0;
      grid-column-start: 1;
      grid-column-end: 4;
      justify-self: center;
      padding-right: 3em;
      padding-left: 2em;
    }
  }
  
  .d-contents nav h3 {
    font-size: 18px;
    margin-top: 0;
    margin-bottom: 1em;
  }
  
  .d-contents li {
    list-style-type: none
  }
  
  .d-contents nav > ul {
    padding-left: 0;
  }
  
  .d-contents ul {
    padding-left: 1em
  }
  
  .d-contents nav ul li {
    margin-top: 0.6em;
    margin-bottom: 0.2em;
  }
  
  .d-contents nav a {
    font-size: 13px;
    border-bottom: none;
    text-decoration: none
    color: rgba(0, 0, 0, 0.8);
  }
  
  .d-contents nav a:hover {
    text-decoration: underline solid rgba(0, 0, 0, 0.6)
  }
  
  .d-contents nav > ul > li > a {
    font-weight: 600;
  }
  
  .d-contents nav > ul > li > ul {
    font-weight: inherit;
  }
  
  .d-contents nav > ul > li > ul > li {
    margin-top: 0.2em;
  }
  
  
  .d-contents nav ul {
    margin-top: 0;
    margin-bottom: 0.25em;
  }
  
  .d-article-with-toc h2:nth-child(2) {
    margin-top: 0;
  }
  
  
  /* Figure */
  
  .figure {
    position: relative;
    margin-bottom: 2.5em;
    margin-top: 1.5em;
  }
  
  .figure img {
    width: 100%;
  }
  
  .figure .caption {
    color: rgba(0, 0, 0, 0.6);
    font-size: 12px;
    line-height: 1.5em;
  }
  
  .figure img.external {
    background: white;
    border: 1px solid rgba(0, 0, 0, 0.1);
    box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
    padding: 18px;
    box-sizing: border-box;
  }
  
  .figure .caption a {
    color: rgba(0, 0, 0, 0.6);
  }
  
  .figure .caption b,
  .figure .caption strong, {
    font-weight: 600;
    color: rgba(0, 0, 0, 1.0);
  }
  
  /* Citations */
  
  d-article .citation {
    color: inherit;
    cursor: inherit;
  }
  
  div.hanging-indent{
    margin-left: 1em; text-indent: -1em;
  }
  
  /* Citation hover box */
  
  .tippy-box[data-theme~=light-border] {
    background-color: rgba(250, 250, 250, 0.95);
  }
  
  .tippy-content > p {
    margin-bottom: 0;
    padding: 2px;
  }
  
  
  /* Tweak 1000px media break to show more text */
  
  @media(min-width: 1000px) {
    .base-grid,
    distill-header,
    d-title,
    d-abstract,
    d-article,
    d-appendix,
    distill-appendix,
    d-byline,
    d-footnote-list,
    d-citation-list,
    distill-footer {
      grid-template-columns: [screen-start] 1fr [page-start kicker-start] 80px [middle-start] 50px [text-start kicker-end] 65px 65px 65px 65px 65px 65px 65px 65px [text-end gutter-start] 65px [middle-end] 65px [page-end gutter-end] 1fr [screen-end];
      grid-column-gap: 16px;
    }
  
    .grid {
      grid-column-gap: 16px;
    }
  
    d-article {
      font-size: 1.06rem;
      line-height: 1.7em;
    }
    figure .caption, .figure .caption, figure figcaption {
      font-size: 13px;
    }
  }
  
  @media(min-width: 1180px) {
    .base-grid,
    distill-header,
    d-title,
    d-abstract,
    d-article,
    d-appendix,
    distill-appendix,
    d-byline,
    d-footnote-list,
    d-citation-list,
    distill-footer {
      grid-template-columns: [screen-start] 1fr [page-start kicker-start] 60px [middle-start] 60px [text-start kicker-end] 60px 60px 60px 60px 60px 60px 60px 60px [text-end gutter-start] 60px [middle-end] 60px [page-end gutter-end] 1fr [screen-end];
      grid-column-gap: 32px;
    }
  
    .grid {
      grid-column-gap: 32px;
    }
  }
  
  
  /* Get the citation styles for the appendix (not auto-injected on render since
     we do our own rendering of the citation appendix) */
  
  d-appendix .citation-appendix,
  .d-appendix .citation-appendix {
    font-size: 11px;
    line-height: 15px;
    border-left: 1px solid rgba(0, 0, 0, 0.1);
    padding-left: 18px;
    border: 1px solid rgba(0,0,0,0.1);
    background: rgba(0, 0, 0, 0.02);
    padding: 10px 18px;
    border-radius: 3px;
    color: rgba(150, 150, 150, 1);
    overflow: hidden;
    margin-top: -12px;
    white-space: pre-wrap;
    word-wrap: break-word;
  }
  
  /* Include appendix styles here so they can be overridden */
  
  d-appendix {
    contain: layout style;
    font-size: 0.8em;
    line-height: 1.7em;
    margin-top: 60px;
    margin-bottom: 0;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
    color: rgba(0,0,0,0.5);
    padding-top: 60px;
    padding-bottom: 48px;
  }
  
  d-appendix h3 {
    grid-column: page-start / text-start;
    font-size: 15px;
    font-weight: 500;
    margin-top: 1em;
    margin-bottom: 0;
    color: rgba(0,0,0,0.65);
  }
  
  d-appendix h3 + * {
    margin-top: 1em;
  }
  
  d-appendix ol {
    padding: 0 0 0 15px;
  }
  
  @media (min-width: 768px) {
    d-appendix ol {
      padding: 0 0 0 30px;
      margin-left: -30px;
    }
  }
  
  d-appendix li {
    margin-bottom: 1em;
  }
  
  d-appendix a {
    color: rgba(0, 0, 0, 0.6);
  }
  
  d-appendix > * {
    grid-column: text;
  }
  
  d-appendix > d-footnote-list,
  d-appendix > d-citation-list,
  d-appendix > distill-appendix {
    grid-column: screen;
  }
  
  /* Include footnote styles here so they can be overridden */
  
  d-footnote-list {
    contain: layout style;
  }
  
  d-footnote-list > * {
    grid-column: text;
  }
  
  d-footnote-list a.footnote-backlink {
    color: rgba(0,0,0,0.3);
    padding-left: 0.5em;
  }
  
  
  
  /* Anchor.js */
  
  .anchorjs-link {
    /*transition: all .25s linear; */
    text-decoration: none;
    border-bottom: none;
  }
  *:hover > .anchorjs-link {
    margin-left: -1.125em !important;
    text-decoration: none;
    border-bottom: none;
  }
  
  /* Social footer */
  
  .social_footer {
    margin-top: 30px;
    margin-bottom: 0;
    color: rgba(0,0,0,0.67);
  }
  
  .disqus-comments {
    margin-right: 30px;
  }
  
  .disqus-comment-count {
    border-bottom: 1px solid rgba(0, 0, 0, 0.4);
    cursor: pointer;
  }
  
  #disqus_thread {
    margin-top: 30px;
  }
  
  .article-sharing a {
    border-bottom: none;
    margin-right: 8px;
  }
  
  .article-sharing a:hover {
    border-bottom: none;
  }
  
  .sidebar-section.subscribe {
    font-size: 12px;
    line-height: 1.6em;
  }
  
  .subscribe p {
    margin-bottom: 0.5em;
  }
  
  
  .article-footer .subscribe {
    font-size: 15px;
    margin-top: 45px;
  }
  
  
  .sidebar-section.custom {
    font-size: 12px;
    line-height: 1.6em;
  }
  
  .custom p {
    margin-bottom: 0.5em;
  }
  
  /* Styles for listing layout (hide title) */
  .layout-listing d-title, .layout-listing .d-title {
    display: none;
  }
  
  /* Styles for posts lists (not auto-injected) */
  
  
  .posts-with-sidebar {
    padding-left: 45px;
    padding-right: 45px;
  }
  
  .posts-list .description h2,
  .posts-list .description p {
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
  }
  
  .posts-list .description h2 {
    font-weight: 700;
    border-bottom: none;
    padding-bottom: 0;
  }
  
  .posts-list h2.post-tag {
    border-bottom: 1px solid rgba(0, 0, 0, 0.2);
    padding-bottom: 12px;
  }
  .posts-list {
    margin-top: 60px;
    margin-bottom: 24px;
  }
  
  .posts-list .post-preview {
    text-decoration: none;
    overflow: hidden;
    display: block;
    border-bottom: 1px solid rgba(0, 0, 0, 0.1);
    padding: 24px 0;
  }
  
  .post-preview-last {
    border-bottom: none !important;
  }
  
  .posts-list .posts-list-caption {
    grid-column: screen;
    font-weight: 400;
  }
  
  .posts-list .post-preview h2 {
    margin: 0 0 6px 0;
    line-height: 1.2em;
    font-style: normal;
    font-size: 24px;
  }
  
  .posts-list .post-preview p {
    margin: 0 0 12px 0;
    line-height: 1.4em;
    font-size: 16px;
  }
  
  .posts-list .post-preview .thumbnail {
    box-sizing: border-box;
    margin-bottom: 24px;
    position: relative;
    max-width: 500px;
  }
  .posts-list .post-preview img {
    width: 100%;
    display: block;
  }
  
  .posts-list .metadata {
    font-size: 12px;
    line-height: 1.4em;
    margin-bottom: 18px;
  }
  
  .posts-list .metadata > * {
    display: inline-block;
  }
  
  .posts-list .metadata .publishedDate {
    margin-right: 2em;
  }
  
  .posts-list .metadata .dt-authors {
    display: block;
    margin-top: 0.3em;
    margin-right: 2em;
  }
  
  .posts-list .dt-tags {
    display: block;
    line-height: 1em;
  }
  
  .posts-list .dt-tags .dt-tag {
    display: inline-block;
    color: rgba(0,0,0,0.6);
    padding: 0.3em 0.4em;
    margin-right: 0.2em;
    margin-bottom: 0.4em;
    font-size: 60%;
    border: 1px solid rgba(0,0,0,0.2);
    border-radius: 3px;
    text-transform: uppercase;
    font-weight: 500;
  }
  
  .posts-list img {
    opacity: 1;
  }
  
  .posts-list img[data-src] {
    opacity: 0;
  }
  
  .posts-more {
    clear: both;
  }
  
  
  .posts-sidebar {
    font-size: 16px;
  }
  
  .posts-sidebar h3 {
    font-size: 16px;
    margin-top: 0;
    margin-bottom: 0.5em;
    font-weight: 400;
    text-transform: uppercase;
  }
  
  .sidebar-section {
    margin-bottom: 30px;
  }
  
  .categories ul {
    list-style-type: none;
    margin: 0;
    padding: 0;
  }
  
  .categories li {
    color: rgba(0, 0, 0, 0.8);
    margin-bottom: 0;
  }
  
  .categories li>a {
    border-bottom: none;
  }
  
  .categories li>a:hover {
    border-bottom: 1px solid rgba(0, 0, 0, 0.4);
  }
  
  .categories .active {
    font-weight: 600;
  }
  
  .categories .category-count {
    color: rgba(0, 0, 0, 0.4);
  }
  
  
  @media(min-width: 768px) {
    .posts-list .post-preview h2 {
      font-size: 26px;
    }
    .posts-list .post-preview .thumbnail {
      float: right;
      width: 30%;
      margin-bottom: 0;
    }
    .posts-list .post-preview .description {
      float: left;
      width: 45%;
    }
    .posts-list .post-preview .metadata {
      float: left;
      width: 20%;
      margin-top: 8px;
    }
    .posts-list .post-preview p {
      margin: 0 0 12px 0;
      line-height: 1.5em;
      font-size: 16px;
    }
    .posts-with-sidebar .posts-list {
      float: left;
      width: 75%;
    }
    .posts-with-sidebar .posts-sidebar {
      float: right;
      width: 20%;
      margin-top: 60px;
      padding-top: 24px;
      padding-bottom: 24px;
    }
  }
  
  
  /* Improve display for browsers without grid (IE/Edge <= 15) */
  
  .downlevel {
    line-height: 1.6em;
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
    margin: 0;
  }
  
  .downlevel .d-title {
    padding-top: 6rem;
    padding-bottom: 1.5rem;
  }
  
  .downlevel .d-title h1 {
    font-size: 50px;
    font-weight: 700;
    line-height: 1.1em;
    margin: 0 0 0.5rem;
  }
  
  .downlevel .d-title p {
    font-weight: 300;
    font-size: 1.2rem;
    line-height: 1.55em;
    margin-top: 0;
  }
  
  .downlevel .d-byline {
    padding-top: 0.8em;
    padding-bottom: 0.8em;
    font-size: 0.8rem;
    line-height: 1.8em;
  }
  
  .downlevel .section-separator {
    border: none;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
  }
  
  .downlevel .d-article {
    font-size: 1.06rem;
    line-height: 1.7em;
    padding-top: 1rem;
    padding-bottom: 2rem;
  }
  
  
  .downlevel .d-appendix {
    padding-left: 0;
    padding-right: 0;
    max-width: none;
    font-size: 0.8em;
    line-height: 1.7em;
    margin-bottom: 0;
    color: rgba(0,0,0,0.5);
    padding-top: 40px;
    padding-bottom: 48px;
  }
  
  .downlevel .footnotes ol {
    padding-left: 13px;
  }
  
  .downlevel .base-grid,
  .downlevel .distill-header,
  .downlevel .d-title,
  .downlevel .d-abstract,
  .downlevel .d-article,
  .downlevel .d-appendix,
  .downlevel .distill-appendix,
  .downlevel .d-byline,
  .downlevel .d-footnote-list,
  .downlevel .d-citation-list,
  .downlevel .distill-footer,
  .downlevel .appendix-bottom,
  .downlevel .posts-container {
    padding-left: 40px;
    padding-right: 40px;
  }
  
  @media(min-width: 768px) {
    .downlevel .base-grid,
    .downlevel .distill-header,
    .downlevel .d-title,
    .downlevel .d-abstract,
    .downlevel .d-article,
    .downlevel .d-appendix,
    .downlevel .distill-appendix,
    .downlevel .d-byline,
    .downlevel .d-footnote-list,
    .downlevel .d-citation-list,
    .downlevel .distill-footer,
    .downlevel .appendix-bottom,
    .downlevel .posts-container {
    padding-left: 150px;
    padding-right: 150px;
    max-width: 900px;
  }
  }
  
  .downlevel pre code {
    display: block;
    border-left: 2px solid rgba(0, 0, 0, .1);
    padding: 0 0 0 20px;
    font-size: 14px;
  }
  
  .downlevel code, .downlevel pre {
    color: black;
    background: none;
    font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
    text-align: left;
    white-space: pre;
    word-spacing: normal;
    word-break: normal;
    word-wrap: normal;
    line-height: 1.5;
  
    -moz-tab-size: 4;
    -o-tab-size: 4;
    tab-size: 4;
  
    -webkit-hyphens: none;
    -moz-hyphens: none;
    -ms-hyphens: none;
    hyphens: none;
  }
  
  .downlevel .posts-list .post-preview {
    color: inherit;
  }
  
  
  
  </style>
  
  <script type="application/javascript">
  
  function is_downlevel_browser() {
    if (bowser.isUnsupportedBrowser({ msie: "12", msedge: "16"},
                                   window.navigator.userAgent)) {
      return true;
    } else {
      return window.load_distill_framework === undefined;
    }
  }
  
  // show body when load is complete
  function on_load_complete() {
  
    // add anchors
    if (window.anchors) {
      window.anchors.options.placement = 'left';
      window.anchors.add('d-article > h2, d-article > h3, d-article > h4, d-article > h5');
    }
  
  
    // set body to visible
    document.body.style.visibility = 'visible';
  
    // force redraw for leaflet widgets
    if (window.HTMLWidgets) {
      var maps = window.HTMLWidgets.findAll(".leaflet");
      $.each(maps, function(i, el) {
        var map = this.getMap();
        map.invalidateSize();
        map.eachLayer(function(layer) {
          if (layer instanceof L.TileLayer)
            layer.redraw();
        });
      });
    }
  
    // trigger 'shown' so htmlwidgets resize
    $('d-article').trigger('shown');
  }
  
  function init_distill() {
  
    init_common();
  
    // create front matter
    var front_matter = $('<d-front-matter></d-front-matter>');
    $('#distill-front-matter').wrap(front_matter);
  
    // create d-title
    $('.d-title').changeElementType('d-title');
  
    // create d-byline
    var byline = $('<d-byline></d-byline>');
    $('.d-byline').replaceWith(byline);
  
    // create d-article
    var article = $('<d-article></d-article>');
    $('.d-article').wrap(article).children().unwrap();
  
    // move posts container into article
    $('.posts-container').appendTo($('d-article'));
  
    // create d-appendix
    $('.d-appendix').changeElementType('d-appendix');
  
    // flag indicating that we have appendix items
    var appendix = $('.appendix-bottom').children('h3').length > 0;
  
    // replace footnotes with <d-footnote>
    $('.footnote-ref').each(function(i, val) {
      appendix = true;
      var href = $(this).attr('href');
      var id = href.replace('#', '');
      var fn = $('#' + id);
      var fn_p = $('#' + id + '>p');
      fn_p.find('.footnote-back').remove();
      var text = fn_p.html();
      var dtfn = $('<d-footnote></d-footnote>');
      dtfn.html(text);
      $(this).replaceWith(dtfn);
    });
    // remove footnotes
    $('.footnotes').remove();
  
    // move refs into #references-listing
    $('#references-listing').replaceWith($('#refs'));
  
    $('h1.appendix, h2.appendix').each(function(i, val) {
      $(this).changeElementType('h3');
    });
    $('h3.appendix').each(function(i, val) {
      var id = $(this).attr('id');
      $('.d-contents a[href="#' + id + '"]').parent().remove();
      appendix = true;
      $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('d-appendix'));
    });
  
    // show d-appendix if we have appendix content
    $("d-appendix").css('display', appendix ? 'grid' : 'none');
  
    // localize layout chunks to just output
    $('.layout-chunk').each(function(i, val) {
  
      // capture layout
      var layout = $(this).attr('data-layout');
  
      // apply layout to markdown level block elements
      var elements = $(this).children().not('details, div.sourceCode, pre, script');
      elements.each(function(i, el) {
        var layout_div = $('<div class="' + layout + '"></div>');
        if (layout_div.hasClass('shaded')) {
          var shaded_content = $('<div class="shaded-content"></div>');
          $(this).wrap(shaded_content);
          $(this).parent().wrap(layout_div);
        } else {
          $(this).wrap(layout_div);
        }
      });
  
  
      // unwrap the layout-chunk div
      $(this).children().unwrap();
    });
  
    // remove code block used to force  highlighting css
    $('.distill-force-highlighting-css').parent().remove();
  
    // remove empty line numbers inserted by pandoc when using a
    // custom syntax highlighting theme
    $('code.sourceCode a:empty').remove();
  
    // load distill framework
    load_distill_framework();
  
    // wait for window.distillRunlevel == 4 to do post processing
    function distill_post_process() {
  
      if (!window.distillRunlevel || window.distillRunlevel < 4)
        return;
  
      // hide author/affiliations entirely if we have no authors
      var front_matter = JSON.parse($("#distill-front-matter").html());
      var have_authors = front_matter.authors && front_matter.authors.length > 0;
      if (!have_authors)
        $('d-byline').addClass('hidden');
  
      // article with toc class
      $('.d-contents').parent().addClass('d-article-with-toc');
  
      // strip links that point to #
      $('.authors-affiliations').find('a[href="#"]').removeAttr('href');
  
      // add orcid ids
      $('.authors-affiliations').find('.author').each(function(i, el) {
        var orcid_id = front_matter.authors[i].orcidID;
        if (orcid_id) {
          var a = $('<a></a>');
          a.attr('href', 'https://orcid.org/' + orcid_id);
          var img = $('<img></img>');
          img.addClass('orcid-id');
          img.attr('alt', 'ORCID ID');
          img.attr('src','data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg==');
          a.append(img);
          $(this).append(a);
        }
      });
  
      // hide elements of author/affiliations grid that have no value
      function hide_byline_column(caption) {
        $('d-byline').find('h3:contains("' + caption + '")').parent().css('visibility', 'hidden');
      }
  
      // affiliations
      var have_affiliations = false;
      for (var i = 0; i<front_matter.authors.length; ++i) {
        var author = front_matter.authors[i];
        if (author.affiliation !== "&nbsp;") {
          have_affiliations = true;
          break;
        }
      }
      if (!have_affiliations)
        $('d-byline').find('h3:contains("Affiliations")').css('visibility', 'hidden');
  
      // published date
      if (!front_matter.publishedDate)
        hide_byline_column("Published");
  
      // document object identifier
      var doi = $('d-byline').find('h3:contains("DOI")');
      var doi_p = doi.next().empty();
      if (!front_matter.doi) {
        // if we have a citation and valid citationText then link to that
        if ($('#citation').length > 0 && front_matter.citationText) {
          doi.html('Citation');
          $('<a href="#citation"></a>')
            .text(front_matter.citationText)
            .appendTo(doi_p);
        } else {
          hide_byline_column("DOI");
        }
      } else {
        $('<a></a>')
           .attr('href', "https://doi.org/" + front_matter.doi)
           .html(front_matter.doi)
           .appendTo(doi_p);
      }
  
       // change plural form of authors/affiliations
      if (front_matter.authors.length === 1) {
        var grid = $('.authors-affiliations');
        grid.children('h3:contains("Authors")').text('Author');
        grid.children('h3:contains("Affiliations")').text('Affiliation');
      }
  
      // remove d-appendix and d-footnote-list local styles
      $('d-appendix > style:first-child').remove();
      $('d-footnote-list > style:first-child').remove();
  
      // move appendix-bottom entries to the bottom
      $('.appendix-bottom').appendTo('d-appendix').children().unwrap();
      $('.appendix-bottom').remove();
  
      // hoverable references
      $('span.citation[data-cites]').each(function() {
        var refHtml = $('#ref-' + $(this).attr('data-cites')).html();
        window.tippy(this, {
          allowHTML: true,
          content: refHtml,
          maxWidth: 500,
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start'
        });
      });
  
      // clear polling timer
      clearInterval(tid);
  
      // show body now that everything is ready
      on_load_complete();
    }
  
    var tid = setInterval(distill_post_process, 50);
    distill_post_process();
  
  }
  
  function init_downlevel() {
  
    init_common();
  
     // insert hr after d-title
    $('.d-title').after($('<hr class="section-separator"/>'));
  
    // check if we have authors
    var front_matter = JSON.parse($("#distill-front-matter").html());
    var have_authors = front_matter.authors && front_matter.authors.length > 0;
  
    // manage byline/border
    if (!have_authors)
      $('.d-byline').remove();
    $('.d-byline').after($('<hr class="section-separator"/>'));
    $('.d-byline a').remove();
  
    // remove toc
    $('.d-contents').remove();
  
    // move appendix elements
    $('h1.appendix, h2.appendix').each(function(i, val) {
      $(this).changeElementType('h3');
    });
    $('h3.appendix').each(function(i, val) {
      $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('.d-appendix'));
    });
  
  
    // inject headers into references and footnotes
    var refs_header = $('<h3></h3>');
    refs_header.text('References');
    $('#refs').prepend(refs_header);
  
    var footnotes_header = $('<h3></h3');
    footnotes_header.text('Footnotes');
    $('.footnotes').children('hr').first().replaceWith(footnotes_header);
  
    // move appendix-bottom entries to the bottom
    $('.appendix-bottom').appendTo('.d-appendix').children().unwrap();
    $('.appendix-bottom').remove();
  
    // remove appendix if it's empty
    if ($('.d-appendix').children().length === 0)
      $('.d-appendix').remove();
  
    // prepend separator above appendix
    $('.d-appendix').before($('<hr class="section-separator" style="clear: both"/>'));
  
    // trim code
    $('pre>code').each(function(i, val) {
      $(this).html($.trim($(this).html()));
    });
  
    // move posts-container right before article
    $('.posts-container').insertBefore($('.d-article'));
  
    $('body').addClass('downlevel');
  
    on_load_complete();
  }
  
  
  function init_common() {
  
    // jquery plugin to change element types
    (function($) {
      $.fn.changeElementType = function(newType) {
        var attrs = {};
  
        $.each(this[0].attributes, function(idx, attr) {
          attrs[attr.nodeName] = attr.nodeValue;
        });
  
        this.replaceWith(function() {
          return $("<" + newType + "/>", attrs).append($(this).contents());
        });
      };
    })(jQuery);
  
    // prevent underline for linked images
    $('a > img').parent().css({'border-bottom' : 'none'});
  
    // mark non-body figures created by knitr chunks as 100% width
    $('.layout-chunk').each(function(i, val) {
      var figures = $(this).find('img, .html-widget');
      if ($(this).attr('data-layout') !== "l-body") {
        figures.css('width', '100%');
      } else {
        figures.css('max-width', '100%');
        figures.filter("[width]").each(function(i, val) {
          var fig = $(this);
          fig.css('width', fig.attr('width') + 'px');
        });
  
      }
    });
  
    // auto-append index.html to post-preview links in file: protocol
    // and in rstudio ide preview
    $('.post-preview').each(function(i, val) {
      if (window.location.protocol === "file:")
        $(this).attr('href', $(this).attr('href') + "index.html");
    });
  
    // get rid of index.html references in header
    if (window.location.protocol !== "file:") {
      $('.distill-site-header a[href]').each(function(i,val) {
        $(this).attr('href', $(this).attr('href').replace("index.html", "./"));
      });
    }
  
    // add class to pandoc style tables
    $('tr.header').parent('thead').parent('table').addClass('pandoc-table');
    $('.kable-table').children('table').addClass('pandoc-table');
  
    // add figcaption style to table captions
    $('caption').parent('table').addClass("figcaption");
  
    // initialize posts list
    if (window.init_posts_list)
      window.init_posts_list();
  
    // implmement disqus comment link
    $('.disqus-comment-count').click(function() {
      window.headroom_prevent_pin = true;
      $('#disqus_thread').toggleClass('hidden');
      if (!$('#disqus_thread').hasClass('hidden')) {
        var offset = $(this).offset();
        $(window).resize();
        $('html, body').animate({
          scrollTop: offset.top - 35
        });
      }
    });
  }
  
  document.addEventListener('DOMContentLoaded', function() {
    if (is_downlevel_browser())
      init_downlevel();
    else
      window.addEventListener('WebComponentsReady', init_distill);
  });
  
  </script>
  
  <!--/radix_placeholder_distill-->
  <script src="site_libs/htmlwidgets-1.5.3/htmlwidgets.js"></script>
  <link href="site_libs/vis-4.20.1/vis.css" rel="stylesheet" />
  <script src="site_libs/vis-4.20.1/vis.min.js"></script>
  <script src="site_libs/visNetwork-binding-2.0.9/visNetwork.js"></script>
  <script src="site_libs/jquery-3.5.1/jquery.min.js"></script>
  <link href="site_libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet" />
  <script src="site_libs/datatables-binding-0.18/datatables.js"></script>
  <link href="site_libs/dt-core-1.10.20/css/jquery.dataTables.min.css" rel="stylesheet" />
  <link href="site_libs/dt-core-1.10.20/css/jquery.dataTables.extra.css" rel="stylesheet" />
  <script src="site_libs/dt-core-1.10.20/js/jquery.dataTables.min.js"></script>
  <link href="site_libs/crosstalk-1.1.1/css/crosstalk.css" rel="stylesheet" />
  <script src="site_libs/crosstalk-1.1.1/js/crosstalk.min.js"></script>
  <script src="site_libs/popper-2.6.0/popper.min.js"></script>
  <link href="site_libs/tippy-6.2.7/tippy.css" rel="stylesheet" />
  <link href="site_libs/tippy-6.2.7/tippy-light-border.css" rel="stylesheet" />
  <script src="site_libs/tippy-6.2.7/tippy.umd.min.js"></script>
  <script src="site_libs/anchor-4.2.2/anchor.min.js"></script>
  <script src="site_libs/bowser-1.9.3/bowser.min.js"></script>
  <script src="site_libs/webcomponents-2.0.0/webcomponents.js"></script>
  <script src="site_libs/distill-2.2.21/template.v2.js"></script>
  <!--radix_placeholder_site_in_header-->
  <!--/radix_placeholder_site_in_header-->


</head>

<body>

<!--radix_placeholder_front_matter-->

<script id="distill-front-matter" type="text/json">
{"title":"Question Answer","description":"Use visual analytics to analyze the available data and evaluate the changing levels of risk to the public and recommend actions.","authors":[{"author":"Linya Huang","authorURL":"#","affiliation":"&nbsp;","affiliationURL":"#","orcidID":""},{"author":"","authorURL":"#","affiliation":"School of Computing and Information Systems, Singapore Management University","affiliationURL":"#","orcidID":""}],"publishedDate":"2021-07-25T00:00:00.000+08:00","citationText":"Huang & , 2021"}
</script>

<!--/radix_placeholder_front_matter-->
<!--radix_placeholder_navigation_before_body-->
<header class="header header--fixed" role="banner">
<nav class="distill-site-nav distill-site-header">
<div class="nav-left">
<a href="index.html" class="title">Linya Huang</a>
</div>
<div class="nav-right">
<a href="index.html">Home</a>
<a href="Introduction.html">Introduction</a>
<a href="Literature_Review.html">Literature Review</a>
<a href="Data_Preprocessing_and_Exploratory.html">Preprocessing and EDA</a>
<a href="Question_Answer.html">Question Answer</a>
<a href="about.html">About</a>
<a href="javascript:void(0);" class="nav-toggle">&#9776;</a>
</div>
</nav>
</header>
<!--/radix_placeholder_navigation_before_body-->
<!--radix_placeholder_site_before_body-->
<!--/radix_placeholder_site_before_body-->

<div class="d-title">
<h1>Question Answer</h1>
<!--radix_placeholder_categories-->
<!--/radix_placeholder_categories-->
<p><p>Use visual analytics to analyze the available data and evaluate the changing levels of risk to the public and recommend actions.</p></p>
</div>

<div class="d-byline">
  Linya Huang  
  
,   
  true
  
<br/>07-25-2021
</div>

<div class="d-article">
<div class="d-contents d-contents-float">
<nav class="l-text toc figcaption" id="TOC">
<h3>Contents</h3>
<ul>
<li><a href="#data-visualization-for-challenge-questions">4.Data Visualization for Challenge Questions</a><ul>
<li><a href="#question1">Question1</a><ul>
<li><a href="#wordcloud-trend-of-30-minutes-time-interval"><strong>Wordcloud trend of 30 minutes time interval</strong></a></li>
<li><a href="#tf_idf-of-30-mintunes-time-interval"><strong>TF_IDF of 30 mintunes time interval</strong></a></li>
<li><a href="#topic-modeling---distinguish-junkspamchatter-from-meaningful-events"><strong>Topic Modeling - Distinguish Junk/Spam/Chatter from Meaningful Events</strong></a></li>
<li><a href="#topic-trend"><strong>Topic Trend</strong></a></li>
<li><a href="#tweetsretweets-and-unique-contents"><strong>Tweets/Retweets and Unique Contents</strong></a></li>
</ul></li>
<li><a href="#question-2">Question 2</a><ul>
<li><a href="#number-of-posts"><strong>Number of posts</strong></a></li>
<li><a href="#tweets-and-retweets-trend"><strong>Tweets and Retweets Trend</strong></a></li>
<li><a href="#monitor-important-news-source---mainstream-media"><strong>Monitor important news source - Mainstream media</strong></a></li>
</ul></li>
<li><a href="#question-3">Question 3</a></li>
</ul></li>
</ul>
</nav>
</div>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>Show code</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>packages</span><span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>'sf'</span>,<span class='st'>'clock'</span>,<span class='st'>'tmap'</span>,
            <span class='st'>'tidyverse'</span>,<span class='st'>'data.table'</span>,<span class='st'>'lubridate'</span>,
            <span class='st'>'textclean'</span>,<span class='st'>'tm'</span>,<span class='st'>'wordcloud'</span>,<span class='st'>'text2vec'</span>,
            <span class='st'>'topicmodels'</span>,<span class='st'>'tidytext'</span>,<span class='st'>'textmineR'</span>,<span class='st'>'quanteda'</span>,
            <span class='st'>'BTM'</span>,<span class='st'>'textplot'</span>,<span class='st'>'concaveman'</span>,<span class='st'>'ggwordcloud'</span>,
            <span class='st'>'qdapDictionaries'</span>,<span class='st'>'textstem'</span>,<span class='st'>'devtools'</span>,<span class='st'>'textnets'</span>,
            <span class='st'>'ggiraph'</span>,<span class='st'>'plotly'</span>,<span class='st'>'igraph'</span>, <span class='st'>'tidygraph'</span>, 
             <span class='st'>'ggraph'</span>, <span class='st'>'visNetwork'</span>,<span class='st'>'udpipe'</span>,<span class='st'>'grid'</span><span class='op'>)</span>

<span class='kw'>for</span><span class='op'>(</span><span class='va'>p</span> <span class='kw'>in</span> <span class='va'>packages</span><span class='op'>)</span><span class='op'>{</span>
  <span class='kw'>if</span><span class='op'>(</span><span class='op'>!</span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>require</a></span><span class='op'>(</span><span class='va'>p</span>,character.only<span class='op'>=</span> <span class='cn'>T</span><span class='op'>)</span><span class='op'>)</span><span class='op'>{</span>
    <span class='fu'><a href='https://rdrr.io/r/utils/install.packages.html'>install.packages</a></span><span class='op'>(</span><span class='va'>p</span><span class='op'>)</span>
    <span class='op'>}</span>
  <span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'>p</span>, character.only <span class='op'>=</span> <span class='cn'>T</span><span class='op'>)</span>
<span class='op'>}</span>
</code></pre>
</div>
</details>
</div>
<h1 id="data-visualization-for-challenge-questions">4.Data Visualization for Challenge Questions</h1>
<h2 id="question1">Question1</h2>
<p><strong>4.1 Using visual analytics, characterize the different types of content in the dataset. What distinguishes meaningful event reports from typical chatter from junk or spam? Please limit your answer to 8 images and 500 words.</strong></p>
<h3 id="wordcloud-trend-of-30-minutes-time-interval"><strong>Wordcloud trend of 30 minutes time interval</strong></h3>
<p>Split data by 30 minutes time interval and perform worldcloud in each interval, to visualize the most frequent words in the microblog.</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>Show code</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'>#split data into 30 minutes time interval</span>

<span class='va'>data</span><span class='op'>$</span><span class='va'>id</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq.int</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span><span class='op'>(</span><span class='va'>data</span><span class='op'>)</span><span class='op'>)</span>

<span class='va'>data_subset</span><span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/subset.html'>subset</a></span><span class='op'>(</span><span class='va'>data</span>,select<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"time_30min"</span>,<span class='st'>"cleaned"</span><span class='op'>)</span><span class='op'>)</span>


<span class='va'>data</span><span class='op'>$</span><span class='va'>timestamp</span> <span class='op'>&lt;-</span> <span class='fu'>ymd_hms</span><span class='op'>(</span><span class='va'>data</span><span class='op'>$</span><span class='va'>`date(yyyyMMddHHmmss)`</span><span class='op'>)</span>
<span class='va'>data</span><span class='op'>$</span><span class='va'>time_30min</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/cut.html'>cut</a></span><span class='op'>(</span><span class='va'>data</span><span class='op'>$</span><span class='va'>timestamp</span>, breaks<span class='op'>=</span><span class='st'>"30 min"</span><span class='op'>)</span>
<span class='va'>data</span><span class='op'>$</span><span class='va'>id</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq.int</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span><span class='op'>(</span><span class='va'>data</span><span class='op'>)</span><span class='op'>)</span>

<span class='va'>data_subset</span><span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/subset.html'>subset</a></span><span class='op'>(</span><span class='va'>data</span>,select<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"time_30min"</span>,<span class='st'>"cleaned"</span><span class='op'>)</span><span class='op'>)</span>


<span class='va'>usenet_words</span><span class='op'>&lt;-</span><span class='va'>data_subset</span><span class='op'>%&gt;%</span>
  <span class='fu'>group_by</span><span class='op'>(</span><span class='va'>time_30min</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>unnest_tokens</span><span class='op'>(</span><span class='va'>word</span>, <span class='va'>cleaned</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>count</span><span class='op'>(</span><span class='va'>time_30min</span>,<span class='va'>word</span>, sort <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>


<span class='va'>usenet_words</span><span class='op'>[</span><span class='fu'><a href='https://rdrr.io/r/base/order.html'>order</a></span><span class='op'>(</span><span class='va'>usenet_words</span><span class='op'>$</span><span class='va'>time_30min</span><span class='op'>)</span>,<span class='op'>]</span>
</code></pre>
</div>
</details>
<pre><code># A tibble: 6,975 x 3
# Groups:   time_30min [10]
   time_30min          word       n
   &lt;fct&gt;               &lt;chr&gt;  &lt;int&gt;
 1 2014-01-23 17:00:00 pok       98
 2 2014-01-23 17:00:00 rally     76
 3 2014-01-23 17:00:00 people    44
 4 2014-01-23 17:00:00 park      40
 5 2014-01-23 17:00:00 jakab     37
 6 2014-01-23 17:00:00 lucio     35
 7 2014-01-23 17:00:00 police    35
 8 2014-01-23 17:00:00 can       34
 9 2014-01-23 17:00:00 abila     30
10 2014-01-23 17:00:00 sylvia    30
# ... with 6,965 more rows</code></pre>
<details>
<summary>Show code</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>usenet_words</span><span class='op'>$</span><span class='va'>time_30min</span><span class='op'>&lt;-</span><span class='va'>usenet_words</span><span class='op'>$</span><span class='va'>time_30min</span> <span class='op'>%&gt;%</span> <span class='fu'>str_replace_all</span><span class='op'>(</span><span class='st'>"2014-01-23 "</span>,<span class='st'>""</span><span class='op'>)</span>
  
<span class='va'>l1</span><span class='op'>&lt;-</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"18:30:00"</span>,<span class='st'>"19:30:00"</span>,<span class='st'>"17:00:00"</span>,<span class='st'>"19:00:00"</span>,<span class='st'>"20:00:00"</span>,<span class='st'>"20:30:00"</span>,<span class='st'>"18:00:00"</span>,<span class='st'>"17:30:00"</span>,<span class='st'>"21:00:00"</span>,<span class='st'>"21:30:00"</span><span class='op'>)</span>
<span class='va'>Time_30min</span><span class='op'>&lt;-</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"18:30-19:00"</span>,<span class='st'>"19:30-20:00"</span>,<span class='st'>"17:00-17:30"</span>,<span class='st'>"19:00-19:30"</span>,<span class='st'>"20:00-20:30"</span>,<span class='st'>"20:30-21:00"</span>,<span class='st'>"18:00-18:30"</span>,<span class='st'>"17:30-18:00"</span>,<span class='st'>"21:00-21:31"</span>,<span class='st'>"21:00-21:31"</span><span class='op'>)</span>
<span class='va'>time_30min_df</span><span class='op'>&lt;-</span><span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span><span class='va'>l1</span>,<span class='va'>Time_30min</span><span class='op'>)</span>
<span class='va'>usenet_words</span><span class='op'>&lt;-</span><span class='fu'>left_join</span><span class='op'>(</span><span class='va'>usenet_words</span>,<span class='va'>time_30min_df</span>,by<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"time_30min"</span><span class='op'>=</span><span class='st'>"l1"</span><span class='op'>)</span><span class='op'>)</span>



<span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>1234</span><span class='op'>)</span>
<span class='va'>usenet_words</span> <span class='op'>%&gt;%</span>
  <span class='fu'>group_by</span><span class='op'>(</span><span class='va'>Time_30min</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>slice_max</span><span class='op'>(</span>order_by <span class='op'>=</span> <span class='va'>n</span>, n <span class='op'>=</span> <span class='fl'>20</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
<span class='fu'>ggplot</span><span class='op'>(</span><span class='fu'>aes</span><span class='op'>(</span>label <span class='op'>=</span> <span class='va'>word</span>,
           size <span class='op'>=</span> <span class='va'>n</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>geom_text_wordcloud</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>theme_minimal</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>facet_wrap</span><span class='op'>(</span><span class='op'>~</span><span class='va'>Time_30min</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<p><img src="Question_Answer_files/figure-html5/unnamed-chunk-2-1.png" width="864" /></p>
</div>
<p>From the visualization, we can tell the main content discussing in the community are</p>
<p>1700-1830 pok rally in park with several name mentioned such as cylvia, jakab, viktor;</p>
<p>1830-1930 fire at dancing dolphin partment, police and evacuation;</p>
<p>1930-2000 shooting and cops/police;</p>
<p>2100-2131 van/ hostage/ explosion;</p>
<h3 id="tf_idf-of-30-mintunes-time-interval"><strong>TF_IDF of 30 mintunes time interval</strong></h3>
<p>Then, by applying Term Frequency  Inverse document frequency (tf-idf) to bigram texts, we can uncover more information compared with uni-grams.</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>Show code</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>data_subset</span><span class='op'>$</span><span class='va'>time_30min</span><span class='op'>&lt;-</span><span class='fu'>str_replace_all</span><span class='op'>(</span><span class='va'>data_subset</span><span class='op'>$</span><span class='va'>time_30min</span>,<span class='st'>"2014-01-23 21:30:00"</span>,<span class='st'>"2014-01-23 21:00:00"</span><span class='op'>)</span>

<span class='va'>bigrams</span> <span class='op'>&lt;-</span> <span class='va'>data_subset</span><span class='op'>%&gt;%</span>
  <span class='fu'>group_by</span><span class='op'>(</span><span class='va'>time_30min</span><span class='op'>)</span><span class='op'>%&gt;%</span>
  <span class='fu'>unnest_tokens</span><span class='op'>(</span><span class='va'>word</span>,
                <span class='va'>cleaned</span>,
                token <span class='op'>=</span> <span class='st'>"ngrams"</span>,
                n <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>count</span><span class='op'>(</span><span class='va'>time_30min</span>,<span class='va'>word</span>, sort <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='fu'>ungroup</span><span class='op'>(</span><span class='op'>)</span>

<span class='co'># bigrams &lt;- data_subset%&gt;%</span>
<span class='co'>#   unnest_tokens(word,</span>
<span class='co'>#                 cleaned,</span>
<span class='co'>#                 token = "ngrams",</span>
<span class='co'>#                 n = 2) %&gt;%</span>
<span class='co'>#   count(time_30min,word, sort = TRUE)</span>


<span class='va'>tf_idf</span> <span class='op'>&lt;-</span> <span class='va'>bigrams</span><span class='op'>%&gt;%</span>
  <span class='fu'>bind_tf_idf</span><span class='op'>(</span><span class='va'>word</span>,<span class='va'>time_30min</span>, <span class='va'>n</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>arrange</span><span class='op'>(</span><span class='fu'>desc</span><span class='op'>(</span><span class='va'>tf_idf</span><span class='op'>)</span><span class='op'>)</span>

<span class='va'>tf_idf</span><span class='op'>$</span><span class='va'>time_30min</span><span class='op'>&lt;-</span><span class='fu'>str_replace_all</span><span class='op'>(</span><span class='va'>tf_idf</span> <span class='op'>$</span><span class='va'>time_30min</span>,<span class='st'>"2014-01-23 "</span>,<span class='st'>""</span><span class='op'>)</span>

<span class='va'>l1</span><span class='op'>&lt;-</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"18:30:00"</span>,<span class='st'>"19:30:00"</span>,<span class='st'>"17:00:00"</span>,<span class='st'>"19:00:00"</span>,<span class='st'>"20:00:00"</span>,<span class='st'>"20:30:00"</span>,<span class='st'>"18:00:00"</span>,<span class='st'>"17:30:00"</span>,<span class='st'>"21:00:00"</span>,<span class='st'>"21:30:00"</span><span class='op'>)</span>
<span class='va'>Time_30min</span><span class='op'>&lt;-</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"18:30-19:00"</span>,<span class='st'>"19:30-20:00"</span>,<span class='st'>"17:00-17:30"</span>,<span class='st'>"19:00-19:30"</span>,<span class='st'>"20:00-20:30"</span>,<span class='st'>"20:30-21:00"</span>,<span class='st'>"18:00-18:30"</span>,<span class='st'>"17:30-18:00"</span>,<span class='st'>"21:00-21:31"</span>,<span class='st'>"21:00-21:31"</span><span class='op'>)</span>
<span class='va'>time_30min_df</span><span class='op'>&lt;-</span><span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span><span class='va'>l1</span>,<span class='va'>Time_30min</span><span class='op'>)</span>

<span class='va'>tf_idf</span><span class='op'>&lt;-</span><span class='fu'>left_join</span><span class='op'>(</span><span class='va'>tf_idf</span>,<span class='va'>time_30min_df</span>,by<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"time_30min"</span><span class='op'>=</span><span class='st'>"l1"</span><span class='op'>)</span><span class='op'>)</span>



<span class='va'>tf_idf</span> <span class='op'>%&gt;%</span>
  <span class='fu'>group_by</span><span class='op'>(</span><span class='va'>Time_30min</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>slice_max</span><span class='op'>(</span><span class='va'>tf_idf</span>,
            n <span class='op'>=</span> <span class='fl'>10</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>ungroup</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>mutate</span><span class='op'>(</span>word <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/stats/reorder.factor.html'>reorder</a></span><span class='op'>(</span><span class='va'>word</span>,
                        <span class='va'>tf_idf</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>ggplot</span><span class='op'>(</span><span class='fu'>aes</span><span class='op'>(</span><span class='va'>tf_idf</span>,
             <span class='va'>word</span>,
             fill <span class='op'>=</span> <span class='va'>Time_30min</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>geom_col</span><span class='op'>(</span>show.legend <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>facet_wrap</span><span class='op'>(</span><span class='op'>~</span> <span class='va'>Time_30min</span>,
             scales <span class='op'>=</span> <span class='st'>"free"</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>labs</span><span class='op'>(</span>x <span class='op'>=</span> <span class='st'>"TF-IDF Bigram in 30 time interval"</span>,
       y <span class='op'>=</span> <span class='cn'>NULL</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<p><img src="Question_Answer_files/figure-html5/unnamed-chunk-3-1.png" width="1152" /></p>
</div>
<p>Without having to process more on data, the contents of the microblogs with 30 mins time interval is even more informative as tf-idf reflects how important a word is to a document in a collection or corpus.</p>
<p>For instance, from 1700-1800, we know that police presense at pok rally and Dr.Audrey is mentioned several times from 1800. Then from 1830 , fire occurs at dolphin apartment and followed by evacuation. Subsequently, from 1930, a shot/gun fire happened with police involved, followed by injured firefighter and hospitalization. And at 2100 suspects were arrested and followed by an explosion at dolphin apartment from 2130 onward.</p>
<h3 id="topic-modeling---distinguish-junkspamchatter-from-meaningful-events"><strong>Topic Modeling - Distinguish Junk/Spam/Chatter from Meaningful Events</strong></h3>
<p>To distinguish meaningful events from chatter/junk/spam messages, I will then perform topic modeling to identify topic in each microblogs.</p>
<p>Top five words in each topics</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>Show code</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>wordcorpus</span> <span class='op'>&lt;-</span> <span class='fu'>Corpus</span><span class='op'>(</span><span class='fu'>VectorSource</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/character.html'>as.character</a></span><span class='op'>(</span><span class='va'>data</span><span class='op'>$</span><span class='va'>cleaned</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>  
<span class='va'>dtm</span> <span class='op'>&lt;-</span> <span class='fu'>DocumentTermMatrix</span><span class='op'>(</span><span class='va'>wordcorpus</span>,
                          control <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>
                            wordLengths<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>2</span>, <span class='cn'>Inf</span><span class='op'>)</span>,               <span class='co'># limit word length</span>
                            bounds <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>global <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>5</span>,<span class='cn'>Inf</span><span class='op'>)</span><span class='op'>)</span>,    <span class='co'># minimum word frequency</span>
                            removeNumbers <span class='op'>=</span> <span class='cn'>TRUE</span>,                <span class='co'>#remove Numbers</span>
                            weighting <span class='op'>=</span> <span class='va'>weightTf</span>,                <span class='co'>#weighted term frequency</span>
                            encoding <span class='op'>=</span> <span class='st'>"UTF-8"</span><span class='op'>)</span><span class='op'>)</span>

<span class='va'>rowTotals</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/apply.html'>apply</a></span><span class='op'>(</span><span class='va'>dtm</span> , <span class='fl'>1</span>, <span class='va'>sum</span><span class='op'>)</span> <span class='co'>#Find the sum of words in each Document</span>
<span class='va'>dtm.new</span>   <span class='op'>&lt;-</span> <span class='va'>dtm</span><span class='op'>[</span><span class='va'>rowTotals</span><span class='op'>&gt;</span> <span class='fl'>0</span>, <span class='op'>]</span> <span class='co'>#remove 0 dtm rows of matrix</span>

<span class='va'>topic</span><span class='op'>=</span><span class='fu'>LDA</span><span class='op'>(</span><span class='va'>dtm.new</span>,k<span class='op'>=</span><span class='fl'>10</span>,method<span class='op'>=</span><span class='st'>"Gibbs"</span>,conrol<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>seed<span class='op'>=</span><span class='fl'>2021</span>,alpha<span class='op'>=</span><span class='fl'>0.01</span>,iter<span class='op'>=</span><span class='fl'>300</span><span class='op'>)</span><span class='op'>)</span>

<span class='fu'><a href='https://rdrr.io/r/stats/terms.html'>terms</a></span><span class='op'>(</span><span class='va'>topic</span>,<span class='fl'>5</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<pre><code>     Topic 1 Topic 2 Topic 3 Topic 4  Topic 5 Topic 6    Topic 7  
[1,] &quot;life&quot;  &quot;can&quot;   &quot;want&quot;  &quot;viktor&quot; &quot;just&quot;  &quot;report&quot;   &quot;fire&quot;   
[2,] &quot;make&quot;  &quot;thing&quot; &quot;good&quot;  &quot;dr&quot;     &quot;come&quot;  &quot;cop&quot;      &quot;abila&quot;  
[3,] &quot;think&quot; &quot;look&quot;  &quot;time&quot;  &quot;newman&quot; &quot;run&quot;   &quot;van&quot;      &quot;dance&quot;  
[4,] &quot;live&quot;  &quot;one&quot;   &quot;stop&quot;  &quot;sylvia&quot; &quot;like&quot;  &quot;shoot&quot;    &quot;dolphin&quot;
[5,] &quot;one&quot;   &quot;great&quot; &quot;give&quot;  &quot;us&quot;     &quot;day&quot;   &quot;evacuate&quot; &quot;arrive&quot; 
     Topic 8   Topic 9  Topic 10  
[1,] &quot;get&quot;     &quot;police&quot; &quot;people&quot;  
[2,] &quot;go&quot;      &quot;pok&quot;    &quot;build&quot;   
[3,] &quot;take&quot;    &quot;rally&quot;  &quot;say&quot;     
[4,] &quot;success&quot; &quot;park&quot;   &quot;resident&quot;
[5,] &quot;two&quot;     &quot;area&quot;   &quot;may&quot;     </code></pre>
</div>
<p>Extract per-topic-per-word probabilities ,(beta), from the model. The higher the value, the more important of the words contribution to the topic.</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>Show code</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>ap_topics</span> <span class='op'>&lt;-</span> <span class='fu'>tidy</span><span class='op'>(</span><span class='va'>topic</span>, matrix <span class='op'>=</span> <span class='st'>"beta"</span><span class='op'>)</span>


<span class='va'>ap_top_terms</span> <span class='op'>&lt;-</span> <span class='va'>ap_topics</span> <span class='op'>%&gt;%</span>
  <span class='fu'>group_by</span><span class='op'>(</span><span class='va'>topic</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>slice_max</span><span class='op'>(</span><span class='va'>beta</span>, n <span class='op'>=</span> <span class='fl'>10</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>ungroup</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>arrange</span><span class='op'>(</span><span class='va'>topic</span>, <span class='op'>-</span><span class='va'>beta</span><span class='op'>)</span>

<span class='va'>ap_top_terms</span> <span class='op'>%&gt;%</span>
  <span class='fu'>mutate</span><span class='op'>(</span>term <span class='op'>=</span> <span class='fu'>reorder_within</span><span class='op'>(</span><span class='va'>term</span>, <span class='va'>beta</span>, <span class='va'>topic</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>ggplot</span><span class='op'>(</span><span class='fu'>aes</span><span class='op'>(</span><span class='va'>beta</span>, <span class='va'>term</span>, fill <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/factor.html'>factor</a></span><span class='op'>(</span><span class='va'>topic</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>geom_col</span><span class='op'>(</span>show.legend <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>facet_wrap</span><span class='op'>(</span><span class='op'>~</span> <span class='va'>topic</span>, scales <span class='op'>=</span> <span class='st'>"free"</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>scale_y_reordered</span><span class='op'>(</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<p><img src="Question_Answer_files/figure-html5/unnamed-chunk-5-1.png" width="768" /></p>
</div>
<p>As shown above, the meaningful keywords can be found in each topic. From the distribution, we can see that in abnormal topic such as topic 1,5 and 9, the top words are dominating the topic, while in other chatter/junk/spam topics, a few normal words has relatively same high beta value. As such, topics can be identified roughly as below.</p>
<p>Topic 1 - police related with evacuation/hostage/standoff</p>
<p>Topic 3 - fire at dancing dolphin</p>
<p>Topic 5- van/guy/cop related</p>
<p>Topic 9 - pok rally</p>
<p>Topic 10 - POK leader</p>
<p>While other topics do not have distinguishable words, resulting the contents related to chatter/junk/spam.</p>
<h3 id="topic-trend"><strong>Topic Trend</strong></h3>
<p>By using gamma value from topic modeling results, we can then assign each document with a topic.</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>Show code</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>topic_gamma</span> <span class='op'>&lt;-</span> <span class='fu'>tidy</span><span class='op'>(</span><span class='va'>topic</span>, matrix <span class='op'>=</span> <span class='st'>"gamma"</span><span class='op'>)</span>
<span class='va'>topic_gamma</span> <span class='op'>&lt;-</span> <span class='va'>topic_gamma</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>group_by</span><span class='op'>(</span><span class='va'>document</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>slice</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/which.min.html'>which.max</a></span><span class='op'>(</span><span class='va'>gamma</span><span class='op'>)</span><span class='op'>)</span>

<span class='va'>topic_gamma</span><span class='op'>$</span><span class='va'>document</span><span class='op'>&lt;-</span><span class='fu'><a href='https://rdrr.io/r/base/numeric.html'>as.numeric</a></span><span class='op'>(</span><span class='va'>topic_gamma</span><span class='op'>$</span><span class='va'>document</span><span class='op'>)</span> 
<span class='co'>#topic_gamma[order(topic_gamma$document),] %&gt;% group_by(topic) %&gt;% count() </span>
<span class='co'>#(topic_gamma%&gt;% arrange(desc(-document)))</span>

<span class='va'>id_time</span> <span class='op'>&lt;-</span> <span class='va'>data</span> <span class='op'>%&gt;%</span> <span class='fu'>select</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"id"</span>,<span class='st'>"time_1min"</span><span class='op'>)</span><span class='op'>)</span>

<span class='va'>topic_data</span><span class='op'>&lt;-</span><span class='fu'>left_join</span><span class='op'>(</span><span class='va'>topic_gamma</span>,<span class='va'>id_time</span>,by<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"document"</span><span class='op'>=</span><span class='st'>"id"</span><span class='op'>)</span><span class='op'>)</span>

<span class='co'>#manually put topics in LDA results</span>

<span class='va'>topic_c</span><span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>,<span class='fl'>2</span>,<span class='fl'>3</span>,<span class='fl'>4</span>,<span class='fl'>5</span>,<span class='fl'>6</span>,<span class='fl'>7</span>,<span class='fl'>8</span>,<span class='fl'>9</span>,<span class='fl'>10</span><span class='op'>)</span>  
<span class='va'>topics_c</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"police"</span>,<span class='st'>"chatter1"</span>,<span class='st'>"chatter2"</span>,<span class='st'>"fire"</span>,<span class='st'>"chatter3"</span>,
<span class='st'>"van"</span>,<span class='st'>"chatter4"</span>,<span class='st'>"chatter5"</span>,<span class='st'>"pokrally"</span>,<span class='st'>"pokleader"</span><span class='op'>)</span>
<span class='va'>topic_df</span><span class='op'>&lt;-</span><span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span><span class='va'>topic_c</span>,<span class='va'>topics_c</span> <span class='op'>)</span>

<span class='va'>topic_data</span><span class='op'>&lt;-</span><span class='fu'>left_join</span><span class='op'>(</span><span class='va'>topic_data</span>,<span class='va'>topic_df</span>,by<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"topic"</span><span class='op'>=</span><span class='st'>"topic_c"</span><span class='op'>)</span><span class='op'>)</span>

<span class='va'>topic_data</span> <span class='op'>%&gt;%</span> <span class='fu'>group_by</span><span class='op'>(</span><span class='va'>time_1min</span>,<span class='va'>topics_c</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='fu'>count</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>ggplot</span><span class='op'>(</span><span class='fu'>aes</span><span class='op'>(</span>x<span class='op'>=</span><span class='va'>time_1min</span><span class='op'>)</span><span class='op'>)</span><span class='op'>+</span>
  <span class='fu'>geom_bar</span><span class='op'>(</span><span class='fu'>aes</span><span class='op'>(</span>y<span class='op'>=</span><span class='va'>n</span><span class='op'>)</span>, stat <span class='op'>=</span> <span class='st'>"identity"</span>,fill <span class='op'>=</span> <span class='st'>"black"</span><span class='op'>)</span><span class='op'>+</span>
  <span class='fu'>facet_wrap</span><span class='op'>(</span><span class='op'>~</span><span class='va'>topics_c</span><span class='op'>)</span><span class='op'>+</span>
  <span class='fu'>theme</span><span class='op'>(</span>axis.title.x<span class='op'>=</span><span class='fu'>element_blank</span><span class='op'>(</span><span class='op'>)</span>,
        axis.text.x<span class='op'>=</span><span class='fu'>element_blank</span><span class='op'>(</span><span class='op'>)</span>,
        axis.ticks.x<span class='op'>=</span><span class='fu'>element_blank</span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span><span class='op'>+</span>
  <span class='fu'>ggtitle</span><span class='op'>(</span><span class='st'>"Topics Trend from 1700-2130"</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<p><img src="Question_Answer_files/figure-html5/unnamed-chunk-6-1.png" width="624" /></p>
</div>
<p>From the topic trend distribution, we can see that chatter topic 1-5 are spread all over the time period, and the number posts are small and randomly distributed. While the peaks of key major events are very obvious at certain point of time.</p>
<p>In summary of topic modeling techniques and visualization, we can identify major event from junk/chatter/spam, and the topic trend visualization can help the audience know about temporal pattern of meaningful events distribution.</p>
<p><strong>Biterm Topic Modeling</strong> The <a href="https://github.com/bnosac/BTM">Biterm Topic Model</a> (BTM) is a word co-occurrence based topic model that learns topics by modeling word-word co-occurrences patterns, which is a generative model. In the generation procedure, a biterm is generated by drawing two words independently from a same topic z.</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>Show code</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'>#Tokenize data</span>
<span class='va'>tidytxtdata</span><span class='op'>&lt;-</span> <span class='fu'>tidy</span><span class='op'>(</span><span class='va'>dtm</span><span class='op'>)</span>

<span class='va'>tidytxtdata</span> <span class='op'>&lt;-</span> <span class='va'>tidytxtdata</span><span class='op'>%&gt;%</span> <span class='co'>#Remove the count column</span>
  <span class='fu'>select</span><span class='op'>(</span><span class='op'>-</span><span class='va'>count</span><span class='op'>)</span>
<span class='va'>tidytxtdata</span> <span class='op'>&lt;-</span> <span class='va'>tidytxtdata</span><span class='op'>%&gt;%</span> <span class='co'>#Change the column name 'term' to 'word' so that we can get rid of stopwords later</span>
  <span class='fu'>rename</span><span class='op'>(</span>word <span class='op'>=</span> <span class='va'>term</span><span class='op'>)</span>


<span class='co'>#Remove stopwords</span>
<span class='va'>tidytxtdata</span> <span class='op'>&lt;-</span> <span class='va'>tidytxtdata</span><span class='op'>%&gt;%</span>
  <span class='fu'>anti_join</span><span class='op'>(</span><span class='va'>stop_words</span><span class='op'>)</span>


<span class='co'>#Use the btm model</span>
<span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>321</span><span class='op'>)</span>
<span class='va'>model</span> <span class='op'>&lt;-</span> <span class='fu'>BTM</span><span class='op'>(</span><span class='va'>tidytxtdata</span>, k <span class='op'>=</span> <span class='fl'>10</span>, beta <span class='op'>=</span> <span class='fl'>0.01</span>, background <span class='op'>=</span> <span class='cn'>TRUE</span>, iter <span class='op'>=</span> <span class='fl'>500</span>, trace <span class='op'>=</span> <span class='fl'>100</span><span class='op'>)</span> <span class='co'>#Run the model</span>

<span class='va'>topicterms</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/terms.html'>terms</a></span><span class='op'>(</span><span class='va'>model</span>, top_n <span class='op'>=</span> <span class='fl'>10</span><span class='op'>)</span> <span class='co'>#View the topics</span>
<span class='co'>#topicterms</span>

<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://github.com/bnosac/textplot'>textplot</a></span><span class='op'>)</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://ggraph.data-imaginist.com'>ggraph</a></span><span class='op'>)</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://joelgombin.github.io/concaveman/'>concaveman</a></span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>model</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<p><img src="Question_Answer_files/figure-html5/unnamed-chunk-7-1.png" width="624" /></p>
</div>
<p>By applying BTM visualization, topic are clusterd in different colors as shown above and words in bold front indicate higher importance in terms of co-occurrence with other words in same topic, which helps to distinguish the meaningful events from typical chatter/junk/spam. For instance, topics in lightblue (with words world-wait-start-improve), lightgreen (with words stop stand) pink (with word mind) have relatively small size of words and tends to have chatter contents. And topic with word life/success in bold face are life related contents which has no meaning. While for topics like fire, van, police, pok rally are more meaningful events in the community.</p>
<h3 id="tweetsretweets-and-unique-contents"><strong>Tweets/Retweets and Unique Contents</strong></h3>
<p>Then, to derive the feature from tweets and re-tweets cotents. I calculated the unique ratio- number of unique contents devided by total tweets of a single user- and reteweet ratio - number of retweets devided by number of total tweets of a single user. These 2 indexes can help us distinguish influential users and junk users.</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>Show code</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>tweet</span><span class='op'>&lt;-</span><span class='va'>data</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://rdrr.io/r/stats/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>author</span><span class='op'>!=</span><span class='st'>"NA"</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>group_by</span><span class='op'>(</span><span class='va'>author</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>count</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>ungroup</span><span class='op'>(</span><span class='op'>)</span>

<span class='va'>retweet</span><span class='op'>&lt;-</span><span class='va'>data</span> <span class='op'>%&gt;%</span>
  <span class='fu'>group_by</span><span class='op'>(</span><span class='va'>RT_from</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>count</span><span class='op'>(</span><span class='op'>)</span><span class='op'>%&gt;%</span> 
  <span class='fu'>ungroup</span><span class='op'>(</span><span class='op'>)</span>

<span class='va'>repeat_data</span><span class='op'>&lt;-</span><span class='va'>data</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://rdrr.io/r/stats/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>author</span><span class='op'>!=</span><span class='st'>"NA"</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>group_by</span><span class='op'>(</span><span class='va'>author</span>,<span class='va'>message</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>count</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>ungroup</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>group_by</span><span class='op'>(</span><span class='va'>author</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>count</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>ungroup</span><span class='op'>(</span><span class='op'>)</span>



<span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>colnames</a></span><span class='op'>(</span><span class='va'>tweet</span><span class='op'>)</span><span class='op'>[</span><span class='fl'>2</span><span class='op'>]</span><span class='op'>&lt;-</span><span class='st'>"tweet"</span>
<span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>colnames</a></span><span class='op'>(</span><span class='va'>retweet</span><span class='op'>)</span><span class='op'>[</span><span class='fl'>2</span><span class='op'>]</span><span class='op'>&lt;-</span><span class='st'>"retweet"</span>
<span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>colnames</a></span><span class='op'>(</span><span class='va'>repeat_data</span><span class='op'>)</span><span class='op'>[</span><span class='fl'>2</span><span class='op'>]</span><span class='op'>&lt;-</span><span class='st'>"repeat"</span>

<span class='va'>tweet_retweet</span><span class='op'>&lt;-</span><span class='fu'>left_join</span><span class='op'>(</span><span class='va'>tweet</span>, <span class='va'>retweet</span>, by <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"author"</span><span class='op'>=</span><span class='st'>"RT_from"</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>tweet_retweet</span><span class='op'>&lt;-</span><span class='fu'>left_join</span><span class='op'>(</span><span class='va'>tweet_retweet</span>, <span class='va'>repeat_data</span>, by <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"author"</span><span class='op'>=</span><span class='st'>"author"</span><span class='op'>)</span><span class='op'>)</span>




<span class='va'>tweet_retweet</span><span class='op'>$</span><span class='va'>retweet_ratio</span><span class='op'>&lt;-</span> <span class='va'>tweet_retweet</span><span class='op'>$</span><span class='va'>retweet</span><span class='op'>/</span><span class='va'>tweet_retweet</span><span class='op'>$</span><span class='va'>tweet</span>
<span class='va'>tweet_retweet</span><span class='op'>$</span><span class='va'>unique_ratio</span> <span class='op'>&lt;-</span><span class='va'>tweet_retweet</span><span class='op'>$</span><span class='st'>'repeat'</span><span class='op'>/</span><span class='va'>tweet_retweet</span><span class='op'>$</span><span class='va'>tweet</span>

<span class='va'>tweet_retweet</span><span class='op'>$</span><span class='va'>retweet</span><span class='op'>&lt;-</span><span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/NA.html'>is.na</a></span><span class='op'>(</span><span class='va'>tweet_retweet</span><span class='op'>$</span><span class='va'>retweet</span><span class='op'>)</span>,<span class='fl'>0</span>,<span class='va'>tweet_retweet</span><span class='op'>$</span><span class='va'>retweet</span><span class='op'>)</span>
<span class='va'>tweet_retweet</span><span class='op'>$</span><span class='va'>retweet_ratio</span><span class='op'>&lt;-</span><span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/NA.html'>is.na</a></span><span class='op'>(</span><span class='va'>tweet_retweet</span><span class='op'>$</span><span class='va'>retweet_ratio</span><span class='op'>)</span>,<span class='fl'>0</span>,<span class='va'>tweet_retweet</span><span class='op'>$</span><span class='va'>retweet_ratio</span><span class='op'>)</span>


<span class='va'>tweet_retweet_2</span><span class='op'>&lt;-</span><span class='va'>tweet_retweet</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='https://rdrr.io/r/stats/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>unique_ratio</span><span class='op'>&lt;</span><span class='fl'>0.8</span> <span class='op'>|</span> <span class='va'>retweet_ratio</span><span class='op'>&gt;=</span><span class='fl'>2</span><span class='op'>)</span>

<span class='fu'>ggplot</span><span class='op'>(</span>data<span class='op'>=</span><span class='va'>tweet_retweet_2</span>,<span class='fu'>aes</span><span class='op'>(</span>x<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/stats/reorder.factor.html'>reorder</a></span><span class='op'>(</span><span class='va'>author</span>,<span class='va'>tweet</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span><span class='op'>+</span>
  <span class='fu'>geom_bar</span><span class='op'>(</span><span class='fu'>aes</span><span class='op'>(</span>y<span class='op'>=</span><span class='va'>tweet</span><span class='op'>)</span>,stat <span class='op'>=</span> <span class='st'>"identity"</span>,fill<span class='op'>=</span><span class='st'>"blue"</span>,alpha<span class='op'>=</span><span class='fl'>0.5</span><span class='op'>)</span><span class='op'>+</span>
  <span class='fu'>geom_bar</span><span class='op'>(</span><span class='fu'>aes</span><span class='op'>(</span>y<span class='op'>=</span><span class='va'>retweet</span><span class='op'>)</span>,stat <span class='op'>=</span> <span class='st'>"identity"</span>,fill<span class='op'>=</span><span class='st'>"red"</span>,alpha<span class='op'>=</span><span class='fl'>0.4</span><span class='op'>)</span><span class='op'>+</span>
  <span class='fu'>geom_point</span><span class='op'>(</span>mapping<span class='op'>=</span><span class='fu'>aes</span><span class='op'>(</span> y<span class='op'>=</span><span class='va'>unique_ratio</span><span class='op'>*</span><span class='fl'>1300</span><span class='op'>)</span>, color<span class='op'>=</span><span class='st'>"black"</span>,size<span class='op'>=</span><span class='fl'>4</span><span class='op'>)</span><span class='op'>+</span>
  <span class='fu'>scale_y_continuous</span><span class='op'>(</span>limits<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>1300</span><span class='op'>)</span>,sec.axis <span class='op'>=</span> <span class='fu'>sec_axis</span><span class='op'>(</span><span class='op'>~</span> <span class='va'>.</span><span class='op'>/</span><span class='fl'>1300</span>,name <span class='op'>=</span> <span class='st'>"Unique Ratio"</span><span class='op'>)</span><span class='op'>)</span><span class='op'>+</span>
  <span class='fu'>theme</span><span class='op'>(</span>axis.text.x <span class='op'>=</span> <span class='fu'>element_text</span><span class='op'>(</span>size<span class='op'>=</span><span class='fl'>8</span>, angle<span class='op'>=</span><span class='fl'>45</span><span class='op'>)</span>,
  panel.border <span class='op'>=</span> <span class='fu'>element_blank</span><span class='op'>(</span><span class='op'>)</span>, 
  panel.background <span class='op'>=</span> <span class='fu'>element_blank</span><span class='op'>(</span><span class='op'>)</span>,
  panel.grid.major <span class='op'>=</span> <span class='fu'>element_blank</span><span class='op'>(</span><span class='op'>)</span>,
  panel.grid.minor <span class='op'>=</span> <span class='fu'>element_blank</span><span class='op'>(</span><span class='op'>)</span>, 
  axis.line <span class='op'>=</span> <span class='fu'>element_line</span><span class='op'>(</span>colour <span class='op'>=</span> <span class='st'>"black"</span><span class='op'>)</span><span class='op'>)</span><span class='op'>+</span>
  <span class='fu'>ggtitle</span><span class='op'>(</span><span class='st'>"Tweets/Retweets and Unique Tweets Ratio"</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<p><img src="Question_Answer_files/figure-html5/unnamed-chunk-8-1.png" width="624" /></p>
</div>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>Show code</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># dt&lt;-subset(data,select=c(timestamp,author,message))</span>
<span class='co'># dt$timestamp&lt;-str_replace_all(dt$timestamp,"2014-01-23 ","")</span>
<span class='co'># dt$message&lt;-iconv(dt$message, 'utf-8', 'ascii', sub='')</span>
<span class='co'># tweet_retweet_2&lt;-subset(tweet_retweet,select=c(author,tweet,retweet))</span>
<span class='co'># dt&lt;-left_join(dt,tweet_retweet_2,by=c("author"="author"))</span>
<span class='co'># dt&lt;-dt %&gt;% filter(author!="")</span>
<span class='co'># # dt&lt;-dt%&gt;% mutate_if(is.character, ~gsub('[^ -~]', '', .)) # remove characters non UTF-8</span>
<span class='co'># DT::datatable(dt)</span>
</code></pre>
</div>
</details>
</div>
<p>By filtering unique_ratio less than 0.8 or retweet_ratio&gt;=2 User with number of tweets does not have any re-tweets and the unique contents of their tweets is low, such as <span class="citation" data-cites="Clevvah4Evah">@Clevvah4Evah</span>, <span class="citation" data-cites="KronosQuoth">@KronosQuoth</span>, and they are mainly posting junk/spam blogs.</p>
<p>For other low unique ratio , users like <span class="citation" data-cites="grassGreeener">@grassGreeener</span>,<span class="citation" data-cites="cheapgoods998">@cheapgoods998</span>,<span class="citation" data-cites="rockinHW">@rockinHW</span>,<span class="citation" data-cites="junkman377">@junkman377</span>,<span class="citation" data-cites="carjunkers">@carjunkers</span>,<span class="citation" data-cites="reggierockin776">@reggierockin776</span> posting repeated advertisement/spam/junk contents are also junk users.</p>
<p>On the other hand, authors with high re-tweet frequency are HomelandIlluminations, <span class="citation" data-cites="AbilaPost">@AbilaPost</span>, <span class="citation" data-cites="KronosStar">@KronosStar</span>, <span class="citation" data-cites="CentralBulletin">@CentralBulletin</span> , <span class="citation" data-cites="NewsOnlineToday">@NewsOnlineToday</span> , and <span class="citation" data-cites="InternationalNews">@InternationalNews</span>, of which the post were more active and meaningful information to the public.</p>
<p><strong>Network Visualization in detecting chatter/spam/junk</strong></p>
<p>Visnetwork packages in R provided interactive capability for network visualization.</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>Show code</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>RT_edges_aggregated</span> <span class='op'>&lt;-</span><span class='va'>data_RT</span><span class='op'>%&gt;%</span>
  <span class='fu'>group_by</span><span class='op'>(</span><span class='va'>RT_from</span>,<span class='va'>author</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>count</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>ungroup</span><span class='op'>(</span><span class='op'>)</span>

<span class='va'>RT_nodes_aggregated</span> <span class='op'>&lt;-</span><span class='va'>data</span><span class='op'>%&gt;%</span>
  <span class='fu'>group_by</span><span class='op'>(</span><span class='va'>author</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>count</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='va'>ungroup</span>


<span class='va'>RT_nodes_aggregated</span><span class='op'>$</span><span class='va'>id</span><span class='op'>&lt;-</span><span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq.int</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span><span class='op'>(</span><span class='va'>RT_nodes_aggregated</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>RT_nodes_aggregated</span><span class='op'>&lt;-</span><span class='va'>RT_nodes_aggregated</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>rename</span><span class='op'>(</span>label<span class='op'>=</span><span class='va'>author</span>,size<span class='op'>=</span><span class='va'>n</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'><a href='https://rdrr.io/r/stats/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>label</span><span class='op'>!=</span><span class='st'>""</span><span class='op'>)</span>
  

  
<span class='va'>RT_edges_aggregated_viz</span><span class='op'>&lt;-</span>
  <span class='fu'>left_join</span><span class='op'>(</span><span class='va'>RT_edges_aggregated</span>,<span class='va'>RT_nodes_aggregated</span>,by<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"RT_from"</span><span class='op'>=</span><span class='st'>"label"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>rename</span><span class='op'>(</span>from<span class='op'>=</span><span class='va'>id</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>left_join</span><span class='op'>(</span><span class='va'>RT_nodes_aggregated</span>,by<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"author"</span><span class='op'>=</span><span class='st'>"label"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>rename</span><span class='op'>(</span>to<span class='op'>=</span><span class='va'>id</span><span class='op'>)</span>

<span class='va'>RT_edges_aggregated_viz</span><span class='op'>&lt;-</span><span class='fu'><a href='https://rdrr.io/r/base/subset.html'>subset</a></span><span class='op'>(</span><span class='va'>RT_edges_aggregated_viz</span>,select<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"from"</span>,<span class='st'>"to"</span><span class='op'>)</span><span class='op'>)</span>


<span class='va'>RT_graph</span> <span class='op'>&lt;-</span> <span class='fu'>tbl_graph</span><span class='op'>(</span>nodes<span class='op'>=</span><span class='va'>RT_nodes_aggregated</span>,
                           edges <span class='op'>=</span> <span class='va'>RT_edges_aggregated</span>,
                           directed <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>

<span class='co'># g &lt;- RT_graph %&gt;%</span>
<span class='co'>#   mutate(betweenness_centrality = centrality_betweenness()) %&gt;%</span>
<span class='co'>#   ggraph(layout = "nicely") +</span>
<span class='co'>#   geom_edge_link(color = "lightblue") +</span>
<span class='co'>#   geom_node_point(aes(color = label,size=n,label=label))+</span>
<span class='co'>#   theme(legend.position = "none")</span>
<span class='co'># </span>
<span class='co'># g</span>

 <span class='fu'>visNetwork</span><span class='op'>(</span><span class='va'>RT_nodes_aggregated</span>, 
            <span class='va'>RT_edges_aggregated_viz</span> , 
            main <span class='op'>=</span> <span class='st'>"Retweet Network"</span>,width<span class='op'>=</span><span class='st'>"100%"</span>, height<span class='op'>=</span><span class='st'>"400px"</span><span class='op'>)</span><span class='op'>%&gt;%</span>
   <span class='fu'>visOptions</span><span class='op'>(</span>highlightNearest <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span><span class='op'>%&gt;%</span>
   <span class='fu'>visNodes</span><span class='op'>(</span>label<span class='op'>=</span><span class='st'>"label"</span>,color <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>background <span class='op'>=</span> <span class='st'>"lightblue"</span>, 
                        border <span class='op'>=</span> <span class='st'>"darkblue"</span>,
                        highlight <span class='op'>=</span> <span class='st'>"yellow"</span><span class='op'>)</span><span class='op'>)</span><span class='op'>%&gt;%</span> 
  <span class='fu'>visIgraphLayout</span><span class='op'>(</span>layout <span class='op'>=</span> <span class='st'>"layout_with_fr"</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<div id="htmlwidget-a49b007c26f3f08e18a9" style="width:100%;height:400px;" class="visNetwork html-widget"></div>
<script type="application/json" data-for="htmlwidget-a49b007c26f3f08e18a9">{"x":{"nodes":{"label":["aaasTech","AbilaAllFaith","AbilaFireDept","AbilaPoliceDepartment","AbilaPost","aliceRocks","anaregents","blueSunshine","BlueVelvet","BoraVerissimo","brain448","brandonL","brewvebeenserved","brontes_riff","carjunkers","CentralBulletin","cheapgoods998","choconibbs","cleaningFish","Clevvah4Evah","cminvestments11","courage4life","creatorRocks","dangermice","deals4realz","dealsRUs101","dirtdigger334","dolls4sale","dragonRider1","dtennent","dtrejos","eazymoney","electricAvenue","eliza003","ernieO","farmboy","fictionalJoe","footfingers","FriendsOfKronos","gardener4958","grassGreeener","GreyCatCollectibles","grlPwrz505","hazMore445","hempRules","hennyhenhendrix","henri","hermanM","HerraTomas","hngohebo_ABILAPOST","HomelandIlluminations","hotdrugs225","InternationalNews","jaques","jenny90210","jgrobannne","joyBubbles","joyce101","joyousNoise","jsmith","junk99902","junkieduck113","junkman377","junkman995","katrina","kedits","kingWilly","klingon4real","KronosQuoth","KronosStar","lindyT","livin4HigherPower","lordWally","luvMyPants","luvwool","maha_Homeland","mailfoool","mainman447","mamin","MarcusDrymiau","martaflores","martaO","maskedWoman101","mattdies","meds4realz43","megaMan","michelleR","microBanana","MindOfKronos","mountain478","muppiesRock","NewsOnlineToday","ninjabob","Officia1AbilaPost","omgponies","onl1neRecords","OnlytheTruth","ourcountryourrights","panopticon","partyon","pashmina887","phantomagate","pinky","plasticParts","POK","powercrystals","praise111","prettyRain","protoGuy","pumpitup","redisrad","reggierockin776","ReggieWassali","rnbwBrite","rockinHW","rockStar113","roger_roger","rrWine","Sara_Nespola","sarajane","SaveOurWildlands","shoutItOut","SiaradSea","siliconKing","Simon_Hamaeth","sithLordJames","skinnyJeans","slamrjamr","sofitees","soulofShi","soup4u","starz1134","stolkfair","stuffNstuff","superhero447","supplementsRule","surferMan","teresaJ","trapanitweets","trollingsnark","truccotrucco","truthforcadau","unicorns","vetsRock","Viktor-E","vonneka","whiteprotein","windAvatar","wireHead1122","wiseWords","worldWatcher","writinLazy","yomamma","zengardener"],"size":[1,12,12,15,72,3,20,27,37,2,35,17,6,10,12,30,9,50,4,153,6,16,1,15,5,6,5,25,24,32,4,9,15,3,2,21,2,20,63,25,4,30,4,1,7,4,26,1,3,3,65,5,17,25,2,22,1,25,1,2,1,5,10,10,4,5,7,23,1265,49,21,2,28,22,2,25,3,3,2,8,5,15,10,2,9,106,7,23,9,2,18,21,22,16,1,1,17,23,25,1,3,27,23,23,67,6,4,23,34,1,16,15,14,22,9,4,37,27,11,33,26,2,14,28,9,27,6,32,14,2,23,3,30,2,5,2,2,20,12,25,64,12,3,30,30,26,9,3,24,26,23,4,6,27],"id":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154],"x":[0.999649736802085,-0.0462475772602161,-0.108675215996558,-0.606267377186107,-0.315285277934094,0.317879496433867,-0.331640267716567,-0.143304481021243,-0.421856203786892,-0.684115967035786,-0.520058814386338,-0.284625992386096,0.115835479098042,-0.701921862713659,0.142346394903176,-0.29409637463454,-0.228216045164831,-0.347303872865062,0.0452095959627921,0.83061159391956,0.658882477218922,-0.281775294357652,-0.555639618735419,-0.116041222987497,0.931383196175425,0.666968959407057,-0.01092540473562,-0.116567363521912,-0.449301849867336,-0.14662372540205,-0.910687705167967,0.890999616054375,-0.300280261647223,0.138394103740988,-0.518706190514393,-0.21669644460417,-0.752950589546341,-0.583105569721438,-0.352903837764482,-0.153789983800033,0.577073668172805,-0.23914327365964,-0.185198508712087,0.308921030948675,-0.418582738099694,-0.147704868693545,-0.488086416179166,-0.339863870666109,-0.231068155243668,-0.884936179257481,-0.328035825922841,0.409072681176677,-0.363756778243433,-0.341385617132931,-0.145412521152223,-0.365746669370069,0.231157191798065,-0.428076625069145,0.970556962170857,0.486691258568748,-0.605773302657639,0.726245750983893,-0.392266414631589,0.870962859802878,0.828611806553787,0.551898257375924,0.128069148856737,-0.504704078942881,0.978325302115302,-0.324084602426561,-0.231882828915568,-0.188552126654263,-0.213379227578699,-0.209964332247979,-0.045843377723404,-0.0491015978788003,1,0.00386110504829351,0.0708329314240927,-0.676647848989976,-0.417545348172015,-0.262642007032576,0.647478697794312,0.852975721884149,0.835742487584004,-0.27440607956271,-0.601635194534185,-0.415187634541302,-0.641898379346332,0.231319183186248,-0.588218011508439,-0.285801443906992,-0.340829988524565,-0.304667843067342,-0.536514121138228,0.128288308784384,-0.253973691639031,-0.466544495489341,-0.424254026257815,0.590211007174623,-0.506320701877675,-0.163220778756754,-0.144287838950394,-0.525329164403406,-0.370184263008479,0.0220318979020013,-0.374343923911857,-0.403420604376051,-0.171500775446467,0.988429041533323,0.0176130998515855,-1,-0.724452234781185,-0.169913423791641,0.78552500529564,-0.844762292534996,-0.303492080282659,-0.109854471967791,-0.570091381783779,-0.403605090751252,-0.359981132142798,-0.50641366995648,-0.437300732729272,-0.203745440529129,-0.1251885137291,-0.457653240212891,-0.882102476665372,-0.491640822570742,-0.254790877457676,0.261783059098,-0.447588304461914,0.26311924560206,-0.331830410251084,-0.791424677277795,0.76331412540632,-0.0893374129264338,0.164599038242287,-0.262649700372244,-0.759731957551897,-0.0832248332158154,-0.317783753935675,-0.0128575386003278,0.769502225220648,-0.253512973489399,-0.282665549874912,-0.0902706476756174,0.82568586390647,0.464304616005629,-0.174130991490236,-0.361266620634087,-0.160885199448699,-0.673796721814667,0.757078914998289,-0.496630502208954],"y":[0.0247342781558251,-0.585869765145869,-0.521907095974112,-0.309094557572253,-0.316525869083728,0.796632037752418,-0.664939738825927,-0.431972592453739,-0.174073187033936,0.860164761541593,-0.299167138576477,-0.564934912811408,-0.201661055292588,-0.316314260170494,0.975479684722091,-0.32661582911982,0.825840495908886,-0.254982269962741,-0.511861727795013,0.218399291702671,0.294093819896502,-0.166786169579709,0.787352703906503,-0.474562912833211,0.337594587141264,-0.884936988765558,1,-0.223788237408011,-0.240074397844811,-0.319240543859101,-0.107341937961198,-0.648692894715355,-0.477916413478743,0.834840881285717,-0.720515360595628,-0.464274007854643,0.739215819531566,-0.150371528810929,-0.235069664815254,-0.168387433622499,0.62339342927574,-0.218548953948358,0.0896900126750144,0.931104754582647,0.0182155762368481,-0.767583237014716,-0.310499426312998,0.98095970063993,-0.894498731865215,-0.373492559738076,-0.306595957742697,0.657636517884192,-0.285169604279884,-0.191637657488655,-0.89153380824039,-0.461058549492724,-0.109539594717598,-0.399156557448701,0.166471952891049,0.505168391153741,0.213721991721818,0.631763491957437,0.83275049476895,-0.50317994307318,-0.356372610888198,-1,-0.686853344290612,-0.350761360762876,-0.412955562050572,-0.330258642733553,-0.165985012292562,0.997706638007912,-0.410393591954607,-0.322525592596177,0.146668250945083,-0.220820834443075,-0.125655846046008,0.773691920207622,0.0618219520332313,-0.594390316569911,0.266249160756082,-0.0128261594181692,0.467675477915345,-0.0313830310175879,-0.184473068048343,-0.281050249720757,-0.6840050362907,-0.434686829535764,-0.0301123948102261,0.683931652370927,-0.22467601419341,-0.312437039586513,-0.138604339280614,-0.52545493747111,0.167908964084598,0.093997023729042,-0.390308155965428,-0.366357050468148,-0.343867587466463,0.759933286822107,0.250207058286696,-0.222180005422988,-0.369124777316722,-0.373241401991167,-0.3173080092952,0.179155641010003,0.138783478277859,-0.554945220215151,-0.281000652329731,-0.262914284103371,-0.10844782384824,0.56781204747243,-0.416127290527563,-0.134909981150087,0.371218317549812,-0.465515981797224,-0.233366698808181,-0.305445701691039,-0.544194349830244,-0.0959056652218723,-0.375594055233934,0.935640872409454,-0.634077618914525,-0.2592492938575,-0.583439432993548,-0.453994545288131,0.695802515443526,-0.424260546306804,-0.0999552554430431,-0.302310475347925,-0.500040690981048,-0.411781931936821,-0.418439767163715,0.0575033890815286,-0.781129745309307,0.88031989631961,-0.570361362059213,-0.551410072260455,-0.130543327435806,-0.153729025332544,-0.28133488812423,-0.427561680145098,0.087225632192818,-0.488629179169572,-0.423966443990226,-0.323517235469526,0.507431225328778,0.836373168410324,-0.39034060265849,-0.127650053696779,-0.194889658284682,0.0927478412670211,-0.621224601477262,-0.154786865218049]},"edges":{"from":[2,2,2,2,3,3,3,3,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,7,7,7,7,13,13,14,14,14,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,19,19,19,24,24,24,24,24,24,24,31,35,35,38,38,38,38,38,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,42,42,42,42,42,42,42,42,43,43,45,45,45,46,46,49,50,51,51,51,51,51,51,51,51,51,51,51,51,51,51,51,51,51,51,51,51,51,51,51,51,51,51,51,51,51,51,51,51,51,51,51,51,51,51,51,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,55,57,61,67,70,70,70,70,70,70,70,70,70,70,70,70,70,70,70,70,70,70,70,70,70,70,70,70,70,70,70,70,70,70,70,70,70,70,70,70,70,70,70,75,76,76,76,76,76,76,76,76,76,79,80,80,81,82,82,82,82,82,86,86,86,86,86,86,86,86,86,86,86,86,86,86,86,86,86,86,86,86,86,86,87,87,89,89,92,92,92,92,92,92,92,92,92,92,92,92,92,92,92,92,92,92,92,92,92,92,92,92,92,92,92,94,94,94,94,94,94,95,96,97,97,97,97,97,97,97,97,98,98,98,98,98,98,98,99,99,99,99,99,99,101,105,105,105,105,105,105,105,105,105,105,105,105,105,105,105,105,106,107,107,108,108,108,108,108,108,109,109,109,109,109,109,109,109,109,109,111,111,111,111,113,113,113,116,117,117,117,117,117,117,117,117,117,117,117,117,119,119,119,119,121,121,121,121,121,121,121,121,121,123,123,123,123,123,125,125,125,125,125,129,129,129,129,129,129,130,132,134,137,139,139,140,140,140,140,140,140,140,141,141,141,141,141,141,141,141,141,141,141,141,141,141,141,141,141,141,142,142,142,142,142,145,145,145,145,145,145,145,145,152],"to":[73,103,138,149,30,88,102,138,29,58,68,88,120,126,8,9,11,12,22,28,29,30,33,36,40,47,54,56,58,68,71,73,74,88,91,93,102,103,104,114,118,120,124,126,128,131,133,138,144,146,149,150,151,154,12,56,58,73,103,114,58,128,154,8,9,11,12,22,29,30,33,36,40,47,54,58,68,71,73,74,93,102,103,114,118,120,124,126,128,131,133,144,146,149,151,154,28,29,40,47,68,71,73,74,103,104,114,126,149,150,154,103,144,146,36,58,118,138,144,149,151,91,56,126,11,54,58,91,150,9,11,29,30,36,54,88,93,104,114,120,124,133,144,150,154,9,28,30,40,56,88,102,151,102,150,9,124,154,138,144,138,104,8,9,11,12,22,28,29,30,33,36,40,47,54,56,58,68,71,73,74,88,91,93,102,103,104,114,118,120,124,126,128,131,133,144,146,149,150,151,154,8,9,11,22,29,47,54,56,58,68,73,74,88,91,93,102,103,104,114,120,124,128,133,144,149,150,151,154,12,28,120,8,8,9,11,12,22,28,29,33,36,40,47,54,56,58,68,71,73,74,88,91,93,102,103,104,114,118,120,124,126,128,131,133,138,144,146,149,150,151,154,151,8,28,40,54,71,102,114,118,149,151,88,128,120,114,120,146,150,154,8,9,12,22,30,33,40,56,58,68,71,93,102,104,114,118,124,133,146,150,151,154,88,131,9,29,8,9,11,22,28,29,30,36,54,56,68,71,88,93,102,103,104,114,124,126,128,133,138,146,149,150,151,33,36,58,103,128,151,150,114,28,30,54,58,68,118,131,146,9,11,58,104,144,149,150,11,33,91,93,118,138,120,9,12,22,28,29,58,68,74,88,114,120,124,128,131,138,150,114,93,150,29,36,73,88,126,133,28,74,118,120,124,133,138,146,149,150,28,40,102,124,11,68,128,68,9,29,47,54,56,88,93,103,118,120,124,149,11,47,131,138,8,54,73,74,120,128,131,138,150,12,104,128,138,144,8,12,33,73,124,9,28,29,73,74,120,118,146,154,149,11,154,22,30,73,102,146,150,151,9,22,29,33,54,56,71,73,88,102,103,114,120,126,128,144,149,150,8,36,73,74,124,8,9,11,74,133,144,146,149,9]},"nodesToDataframe":true,"edgesToDataframe":true,"options":{"width":"100%","height":"100%","nodes":{"shape":"dot","label":"label","color":{"background":"lightblue","border":"darkblue","highlight":"yellow"},"physics":false},"manipulation":{"enabled":false},"edges":{"smooth":false},"physics":{"stabilization":false}},"groups":null,"width":"100%","height":"400px","idselection":{"enabled":false,"style":"width: 150px; height: 26px","useLabels":true,"main":"Select by id"},"byselection":{"enabled":false,"style":"width: 150px; height: 26px","multiple":false,"hideColor":"rgba(200,200,200,0.5)","highlight":false},"main":{"text":"Retweet Network","style":"font-family:Georgia, Times New Roman, Times, serif;font-weight:bold;font-size:20px;text-align:center;"},"submain":null,"footer":null,"background":"rgba(0, 0, 0, 0)","highlight":{"enabled":true,"hoverNearest":false,"degree":1,"algorithm":"all","hideColor":"rgba(200,200,200,0.5)","labelOnly":true},"collapse":{"enabled":false,"fit":false,"resetHighlight":true,"clusterOptions":null,"keepCoord":true,"labelSuffix":"(cluster)"},"igraphlayout":{"type":"square"}},"evals":[],"jsHooks":[]}</script>
</div>
<p>For the plot above, click the nodes and zoom in the graph, the selected node and its network will be highlighted, which can provided the information of how many people are directly affected by the original author and the size of the dot indicates the total number of posts by users.</p>
<p>This chart can be applied to answer quetions 1 and 2.</p>
<p>From the chart, we can tell thatthe authors in the center like <span class="citation" data-cites="HomelandIlluminations">@HomelandIlluminations</span>/<span class="citation" data-cites="AbilaPost">@AbilaPost</span>/<span class="citation" data-cites="KronosStar">@KronosStar</span>/<span class="citation" data-cites="CentralBulletin">@CentralBulletin</span>/<span class="citation" data-cites="NewsOnlineToday">@NewsOnlineToday</span>/<span class="citation" data-cites="InternationalNews">@InternationalNews</span> have affected the public most directly and widely. And users like <span class="citation" data-cites="Clevvah4Evah">@Clevvah4Evah</span>, <span class="citation" data-cites="KronosQuoth">@KronosQuoth</span> have quite number of junk posting with no re-tweets, while other users with no link post mainly chatter/spam contents.</p>
<h2 id="question-2">Question 2</h2>
<p><strong>4.2 Use visual analytics to represent and evaluate how the level of the risk to the public evolves over the course of the evening. Consider the potential consequences of the situation and the number of people who could be affected. Please limit your answer to 10 images and 1000 words.</strong></p>
<h3 id="number-of-posts"><strong>Number of posts</strong></h3>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>Show code</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>count</span> <span class='op'>&lt;-</span> <span class='va'>data</span> <span class='op'>%&gt;%</span>
  <span class='fu'>group_by</span><span class='op'>(</span><span class='va'>type</span>,<span class='va'>time_1min</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>summarise</span><span class='op'>(</span>count_of_posts<span class='op'>=</span> <span class='fu'>n_distinct</span><span class='op'>(</span><span class='va'>message</span><span class='op'>)</span><span class='op'>)</span>

<span class='va'>count</span><span class='op'>$</span><span class='va'>time_1min</span><span class='op'>=</span><span class='fu'>ymd_hms</span><span class='op'>(</span><span class='va'>count</span><span class='op'>$</span><span class='va'>time_1min</span><span class='op'>)</span>
<span class='co'>#count$time_1min=format(count$time_1min,format = "%H:%M:%S") </span>

<span class='va'>mean</span><span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>count</span><span class='op'>$</span><span class='va'>count_of_posts</span><span class='op'>)</span>

<span class='fu'>ggplot</span><span class='op'>(</span><span class='va'>count</span>,<span class='fu'>aes</span><span class='op'>(</span>x<span class='op'>=</span><span class='va'>time_1min</span>,y<span class='op'>=</span><span class='va'>count_of_posts</span>,fill<span class='op'>=</span><span class='va'>type</span><span class='op'>)</span><span class='op'>)</span><span class='op'>+</span>
         <span class='fu'>geom_bar</span><span class='op'>(</span>stat<span class='op'>=</span><span class='st'>"identity"</span>,position<span class='op'>=</span><span class='st'>"dodge"</span><span class='op'>)</span><span class='op'>+</span>
  <span class='co'># geom_abline(h=mean, col = "black")+</span>
  <span class='fu'>theme</span><span class='op'>(</span>axis.text.x <span class='op'>=</span> <span class='fu'>element_text</span><span class='op'>(</span>angle <span class='op'>=</span> <span class='fl'>90</span>, hjust <span class='op'>=</span> <span class='fl'>1</span><span class='op'>)</span><span class='op'>)</span><span class='op'>+</span>
  <span class='fu'>ggtitle</span><span class='op'>(</span><span class='st'>"Total Number of Posts through the period"</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<img src="Question_Answer_files/figure-html5/unnamed-chunk-11-1.png" width="624" />
<details>
<summary>Show code</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span><span class='va'>count</span><span class='op'>[</span><span class='fu'><a href='https://rdrr.io/r/base/order.html'>order</a></span><span class='op'>(</span><span class='op'>-</span><span class='va'>count</span><span class='op'>$</span><span class='va'>count_of_posts</span><span class='op'>)</span>,<span class='op'>]</span>,<span class='fl'>10</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<pre><code># A tibble: 10 x 3
# Groups:   type [1]
   type   time_1min           count_of_posts
   &lt;chr&gt;  &lt;dttm&gt;                       &lt;int&gt;
 1 mbdata 2014-01-23 19:43:00             61
 2 mbdata 2014-01-23 19:41:00             60
 3 mbdata 2014-01-23 19:44:00             48
 4 mbdata 2014-01-23 19:45:00             48
 5 mbdata 2014-01-23 18:47:00             47
 6 mbdata 2014-01-23 18:45:00             44
 7 mbdata 2014-01-23 18:52:00             38
 8 mbdata 2014-01-23 19:40:00             38
 9 mbdata 2014-01-23 20:10:00             38
10 mbdata 2014-01-23 19:46:00             33</code></pre>
</div>
<p>With time interval at 1 minute, the sum number of posts is plotted in bar chart as above. The peaks of both ccdata and mbdata are observed during time 19:40-19:50, 18:45:00 and 20:10:00.</p>
<h3 id="tweets-and-retweets-trend"><strong>Tweets and Retweets Trend</strong></h3>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>Show code</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>data_rt2</span><span class='op'>&lt;-</span><span class='va'>data</span> <span class='op'>%&gt;%</span> 
   <span class='co'>#filter(str_detect(message, "fire")) %&gt;% </span>
  <span class='fu'>select</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"author"</span>,<span class='st'>"time_1min"</span>,<span class='st'>"message"</span>,<span class='st'>"RT_from"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>group_by</span><span class='op'>(</span><span class='va'>time_1min</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>summarise</span><span class='op'>(</span>post<span class='op'>=</span><span class='fu'>n</span><span class='op'>(</span><span class='op'>)</span>,
            rt_post<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>RT_from</span><span class='op'>!=</span><span class='st'>""</span><span class='op'>)</span><span class='op'>)</span>

<span class='va'>data_rt2</span><span class='op'>$</span><span class='va'>time_1min</span><span class='op'>=</span><span class='fu'>ymd_hms</span><span class='op'>(</span><span class='va'>data_rt2</span><span class='op'>$</span><span class='va'>time_1min</span><span class='op'>)</span>


<span class='co'>#ggplot(fire,aes(x=time_1min,y=n))+</span>
         <span class='co'>#geom_bar(stat="identity",position="dodge")+</span>
  <span class='co'>#theme(axis.text.x = element_text(angle = 90, hjust = 1))+</span>
  <span class='co'>#ggtitle("Total Number of Posts through the period")</span>


<span class='fu'>ggplot</span><span class='op'>(</span><span class='va'>data_rt2</span>,<span class='fu'>aes</span><span class='op'>(</span>x<span class='op'>=</span><span class='va'>time_1min</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
    <span class='fu'>geom_bar</span><span class='op'>(</span><span class='fu'>aes</span><span class='op'>(</span>y<span class='op'>=</span><span class='va'>post</span><span class='op'>)</span>, stat <span class='op'>=</span> <span class='st'>"identity"</span>,fill <span class='op'>=</span> <span class='st'>"red"</span><span class='op'>)</span> <span class='op'>+</span>
    <span class='fu'>geom_bar</span><span class='op'>(</span><span class='fu'>aes</span><span class='op'>(</span>y<span class='op'>=</span><span class='va'>rt_post</span><span class='op'>)</span>, stat <span class='op'>=</span> <span class='st'>"identity"</span>,fill <span class='op'>=</span> <span class='st'>"blue"</span><span class='op'>)</span> <span class='op'>+</span>
    <span class='fu'>theme</span><span class='op'>(</span>axis.text.x <span class='op'>=</span> <span class='fu'>element_text</span><span class='op'>(</span>angle <span class='op'>=</span> <span class='fl'>90</span>, hjust <span class='op'>=</span> <span class='fl'>1</span><span class='op'>)</span><span class='op'>)</span><span class='op'>+</span>
    <span class='fu'>ggtitle</span><span class='op'>(</span><span class='st'>"Tweet and Re-Tweets Trend"</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<p><img src="Question_Answer_files/figure-html5/unnamed-chunk-12-1.png" width="624" /></p>
</div>
<p>Another way to detect the active level of microblog is to visualize the proportion of re-tweet/tweet. As shown in the bar graph above, the peak trend coincides with Total Number of Posts through the period, indicating the people are actively eveloved in the events happening in Abila.</p>
<p>The goverment can monitor the ratio of retweet in community to detect abnormal event.</p>
<h3 id="monitor-important-news-source---mainstream-media"><strong>Monitor important news source - Mainstream media</strong></h3>
<p>Noticed that the mainstream media (with name starting with capital letter and frequently re-tweet by public) are actively quoted media for Abila.</p>
<p><span class="citation" data-cites="HomelandIlluminations">@HomelandIlluminations</span>/<span class="citation" data-cites="AbilaPost">@AbilaPost</span>/<span class="citation" data-cites="KronosStar">@KronosStar</span>/<span class="citation" data-cites="CentralBulletin">@CentralBulletin</span>/<span class="citation" data-cites="NewsOnlineToday">@NewsOnlineToday</span>/<span class="citation" data-cites="InternationalNews">@InternationalNews</span> are top6 social media. Their tweet should be closely monitored by local authorities, in particular, when the frequency of re-tweet from the public has raised.</p>
<p>For instance, to understand peoples attention of the abnormal events, we can monitor the words and its relationships in main stream medias re-tweets.</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>Show code</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># check if the media is mainstream media</span>

<span class='va'>data_RT</span> <span class='op'>%&gt;%</span> 
  <span class='fu'><a href='https://rdrr.io/r/stats/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>RT_from</span><span class='op'>!=</span><span class='va'>author</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>count</span><span class='op'>(</span><span class='va'>RT_from</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>arrange</span><span class='op'>(</span><span class='fu'>desc</span><span class='op'>(</span><span class='va'>n</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'><a href='https://rdrr.io/r/stats/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>n</span><span class='op'>&gt;</span><span class='fl'>40</span><span class='op'>)</span> <span class='co'># filter the retweet over 10 times by public</span>
</code></pre>
</div>
</details>
<pre><code>                 RT_from   n
1: HomelandIlluminations 183
2:             AbilaPost 169
3:            KronosStar 143
4:       CentralBulletin  78
5:       NewsOnlineToday  44
6:     InternationalNews  43</code></pre>
<details>
<summary>Show code</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'>#convert dataframe to corpus</span>

<span class='va'>data_RT_main</span><span class='op'>&lt;-</span><span class='va'>data</span> <span class='op'>%&gt;%</span> 
  <span class='fu'><a href='https://rdrr.io/r/stats/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>RT_from</span><span class='op'>==</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"HomelandIlluminations"</span>,<span class='st'>"AbilaPost"</span>,
                    <span class='st'>"KronosStar"</span>,<span class='st'>"CentralBulletin"</span>,
                    <span class='st'>"NewsOnlineToday"</span>,<span class='st'>"InternationalNews"</span><span class='op'>)</span><span class='op'>)</span>


<span class='va'>data_RT_main</span><span class='op'>$</span><span class='va'>id</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq.int</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span><span class='op'>(</span><span class='va'>data_RT_main</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>data_RT_subset</span><span class='op'>&lt;-</span><span class='va'>data_RT_main</span> <span class='op'>%&gt;%</span> <span class='fu'>select</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"id"</span>,<span class='st'>"RT_message"</span><span class='op'>)</span><span class='op'>)</span>


<span class='va'>data_RT_subset</span><span class='op'>$</span><span class='va'>RT_message_cleaned</span><span class='op'>&lt;-</span>
  <span class='fu'><a href='https://rdrr.io/r/base/chartr.html'>tolower</a></span><span class='op'>(</span><span class='va'>data_RT_subset</span><span class='op'>$</span><span class='va'>RT_message</span><span class='op'>)</span><span class='op'>%&gt;%</span>   <span class='co'># transform all message to lower cases</span>
  <span class='fu'>replace_contraction</span><span class='op'>(</span><span class='op'>)</span><span class='op'>%&gt;%</span>   <span class='co'>#replace contractions with long form</span>
  <span class='fu'>replace_word_elongation</span><span class='op'>(</span><span class='op'>)</span><span class='op'>%&gt;%</span> 
  <span class='fu'>str_replace_all</span><span class='op'>(</span><span class='st'>"[0-9]"</span>, <span class='st'>""</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='co'>#removing numbers</span>
  <span class='fu'>str_replace_all</span><span class='op'>(</span><span class='st'>"([,=!.?$+%-&amp;#@])"</span>,<span class='st'>""</span><span class='op'>)</span><span class='op'>%&gt;%</span> <span class='co'>#remove punctuations</span>
  <span class='fu'>str_replace_all</span><span class='op'>(</span><span class='st'>"abila|abilapost|centralbulletin|kronosstar|pok|rally"</span>,<span class='st'>""</span><span class='op'>)</span><span class='op'>%&gt;%</span> 
  <span class='fu'>removeWords</span><span class='op'>(</span><span class='fu'>stopwords</span><span class='op'>(</span><span class='st'>"english"</span><span class='op'>)</span><span class='op'>)</span><span class='op'>%&gt;%</span> 
  <span class='fu'>str_squish</span><span class='op'>(</span><span class='op'>)</span><span class='op'>%&gt;%</span> 
  <span class='va'>str_trim</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>lemmatize_strings</span><span class='op'>(</span><span class='op'>)</span>


<span class='va'>x</span><span class='op'>&lt;-</span><span class='va'>data_RT_subset</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>unnest_tokens</span><span class='op'>(</span><span class='va'>word</span>, <span class='va'>RT_message_cleaned</span><span class='op'>)</span>

<span class='va'>x</span><span class='op'>&lt;-</span><span class='fu'>cooccurrence</span><span class='op'>(</span><span class='va'>x</span>, group <span class='op'>=</span> <span class='st'>"id"</span>, term <span class='op'>=</span> <span class='st'>"word"</span><span class='op'>)</span>

<span class='va'>plt</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/textplot/man/textplot_cooccurrence.html'>textplot_cooccurrence</a></span><span class='op'>(</span><span class='va'>x</span>,
                             title <span class='op'>=</span> <span class='st'>"Re-tweet Co-occurrences"</span>, top_n <span class='op'>=</span> <span class='fl'>150</span><span class='op'>)</span>

<span class='va'>plt</span>
</code></pre>
</div>
</details>
<p><img src="Question_Answer_files/figure-html5/unnamed-chunk-13-1.png" width="624" /></p>
</div>
<p>In the re-tweet from the main media, high occurrence of fire at dolphin apartement has the most co-occurrence re-tweets, indicating highest attention and risk in the community, followed by several events involved with police such as post of pokrally/ arrive at scene. While in the edge of the visualization, we can found that the small group of public was interested in re-tweet firefighter injure at hospital/ suspect arrest, which has less risk in the community.</p>
<h2 id="question-3">Question 3</h2>
<p><strong>4.3 If you were able to send a team of first responders to any single place, where would it be? Provide your rationale. How might your response be different if you had to respond to the events in real time rather than retrospectively? Please limit your answer to 8 images and 500 words.</strong></p>
<p>To send team of responders and make sure right location and short responding time, we can take a closely look location-tagged posts or posts contents with locations.</p>
<p><strong>On retrospective appraoch, I will send team of first respondents to dolphin dancing apartment.</strong></p>
<p>Reasons as below,</p>
<ol type="1">
<li><p>The fire event at dolphin get the most attention and risk from the public according to previous analysis, causing the most injures. In addition, dolphin department was frequently mentioned in the microblog by mainstream media and individual users.</p></li>
<li><p>Comparing to other event, some are reported by only a few individual users with vague locations mentioned in the latter time, the fire at dolphin apartment has been reported with an accurate location at early time around 18:40.</p></li>
</ol>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>Show code</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>packages</span><span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>'sp'</span>,<span class='st'>'sf'</span>,<span class='st'>'gridExtra'</span>,<span class='st'>'mapview'</span><span class='op'>)</span>

<span class='kw'>for</span><span class='op'>(</span><span class='va'>p</span> <span class='kw'>in</span> <span class='va'>packages</span><span class='op'>)</span><span class='op'>{</span>
  <span class='kw'>if</span><span class='op'>(</span><span class='op'>!</span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>require</a></span><span class='op'>(</span><span class='va'>p</span>,character.only<span class='op'>=</span> <span class='cn'>T</span><span class='op'>)</span><span class='op'>)</span><span class='op'>{</span>
    <span class='fu'><a href='https://rdrr.io/r/utils/install.packages.html'>install.packages</a></span><span class='op'>(</span><span class='va'>p</span><span class='op'>)</span>
    <span class='op'>}</span>
  <span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'>p</span>, character.only <span class='op'>=</span> <span class='cn'>T</span><span class='op'>)</span>
<span class='op'>}</span>
</code></pre>
</div>
</details>
</div>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>Show code</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>abila</span><span class='op'>&lt;-</span><span class='fu'>st_read</span><span class='op'>(</span><span class='st'>'data/MC3/Geospatial/Abila.shp'</span>,quiet<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span>


<span class='va'>data_location</span> <span class='op'>&lt;-</span> <span class='va'>data</span> <span class='op'>%&gt;%</span> 
  <span class='fu'><a href='https://rdrr.io/r/stats/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>longitude</span><span class='op'>!=</span><span class='st'>""</span> <span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>add_count</span><span class='op'>(</span><span class='va'>longitude</span>,<span class='va'>latitude</span>,<span class='va'>author</span><span class='op'>)</span>

<span class='va'>dangermice</span> <span class='op'>&lt;-</span> <span class='va'>data_location</span> <span class='op'>%&gt;%</span> 
  <span class='fu'><a href='https://rdrr.io/r/stats/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>author</span><span class='op'>==</span><span class='st'>"dangermice"</span> <span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>select</span><span class='op'>(</span><span class='va'>timestamp</span>,<span class='va'>message</span>,<span class='va'>longitude</span>,<span class='va'>latitude</span><span class='op'>)</span> 


<span class='va'>p1</span><span class='op'>&lt;-</span><span class='fu'>ggplot</span><span class='op'>(</span><span class='op'>)</span><span class='op'>+</span>
  <span class='fu'>geom_sf</span><span class='op'>(</span>data<span class='op'>=</span><span class='va'>abila</span>,size<span class='op'>=</span><span class='fl'>0.2</span>,color<span class='op'>=</span><span class='st'>"black"</span>,fill<span class='op'>=</span><span class='st'>"cyan1"</span><span class='op'>)</span><span class='op'>+</span>
  <span class='fu'>ggtitle</span><span class='op'>(</span><span class='st'>"Fire at Dancing Dolphin Apartment"</span><span class='op'>)</span><span class='op'>+</span>
  <span class='fu'>coord_sf</span><span class='op'>(</span><span class='op'>)</span><span class='op'>+</span>
  <span class='fu'>theme</span><span class='op'>(</span>panel.background <span class='op'>=</span> <span class='fu'>element_rect</span><span class='op'>(</span>fill <span class='op'>=</span> <span class='st'>"transparent"</span><span class='op'>)</span>, <span class='co'># bg of the panel</span>
    plot.background <span class='op'>=</span> <span class='fu'>element_rect</span><span class='op'>(</span>fill <span class='op'>=</span> <span class='st'>"transparent"</span>, color <span class='op'>=</span> <span class='cn'>NA</span><span class='op'>)</span>, <span class='co'># bg of the plot</span>
    panel.grid.major <span class='op'>=</span> <span class='fu'>element_blank</span><span class='op'>(</span><span class='op'>)</span>, <span class='co'># get rid of major grid</span>
    panel.grid.minor <span class='op'>=</span> <span class='fu'>element_blank</span><span class='op'>(</span><span class='op'>)</span>, <span class='co'># get rid of minor grid</span>
    legend.background <span class='op'>=</span> <span class='fu'>element_rect</span><span class='op'>(</span>fill <span class='op'>=</span> <span class='st'>"transparent"</span><span class='op'>)</span>, <span class='co'># get rid of legend bg</span>
    legend.box.background <span class='op'>=</span> <span class='fu'>element_rect</span><span class='op'>(</span>fill <span class='op'>=</span> <span class='st'>"transparent"</span><span class='op'>)</span>,<span class='co'># get rid of legend panel bg)</span>
    axis.text.x <span class='op'>=</span> <span class='fu'>element_blank</span><span class='op'>(</span><span class='op'>)</span>,
  axis.text.y <span class='op'>=</span> <span class='fu'>element_blank</span><span class='op'>(</span><span class='op'>)</span>,
  axis.ticks <span class='op'>=</span> <span class='fu'>element_blank</span><span class='op'>(</span><span class='op'>)</span>,
  axis.title.y<span class='op'>=</span><span class='fu'>element_blank</span><span class='op'>(</span><span class='op'>)</span>,
  axis.title.x <span class='op'>=</span><span class='fu'>element_blank</span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>geom_point</span><span class='op'>(</span>data <span class='op'>=</span> <span class='va'>dangermice</span>, <span class='fu'>aes</span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>longitude</span>,y<span class='op'>=</span><span class='va'>latitude</span><span class='op'>)</span>,color<span class='op'>=</span><span class='st'>"red"</span>,size<span class='op'>=</span><span class='fl'>2</span><span class='op'>)</span>



<span class='va'>data_fire</span> <span class='op'>&lt;-</span> <span class='va'>data</span> <span class='op'>%&gt;%</span> 
  <span class='fu'><a href='https://rdrr.io/r/stats/filter.html'>filter</a></span><span class='op'>(</span><span class='fu'>str_detect</span><span class='op'>(</span><span class='va'>message</span>,<span class='st'>"fire|explosion|dolpin"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>select</span><span class='op'>(</span><span class='va'>message</span>, <span class='va'>timestamp</span>,<span class='va'>cleaned</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>unnest_tokens</span><span class='op'>(</span><span class='va'>word</span>, <span class='va'>cleaned</span><span class='op'>)</span>

<span class='va'>data_fire_words</span> <span class='op'>&lt;-</span> <span class='va'>data_fire</span> <span class='op'>%&gt;%</span>
  <span class='fu'>count</span><span class='op'>(</span><span class='va'>word</span>, sort <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>ungroup</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>arrange</span><span class='op'>(</span><span class='fu'>desc</span><span class='op'>(</span><span class='va'>n</span><span class='op'>)</span><span class='op'>)</span>



<span class='va'>p2</span><span class='op'>&lt;-</span> <span class='fu'>ggplot</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span><span class='va'>data_fire_words</span>,<span class='fl'>50</span><span class='op'>)</span>,<span class='fu'>aes</span><span class='op'>(</span>label <span class='op'>=</span> <span class='va'>word</span>,
           size <span class='op'>=</span> <span class='va'>n</span>,color<span class='op'>=</span><span class='va'>n</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>geom_text_wordcloud</span><span class='op'>(</span><span class='op'>)</span><span class='op'>+</span>
  <span class='fu'>scale_size_area</span><span class='op'>(</span>max_size <span class='op'>=</span> <span class='fl'>10</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>theme</span><span class='op'>(</span>panel.background <span class='op'>=</span> <span class='fu'>element_rect</span><span class='op'>(</span>fill <span class='op'>=</span> <span class='st'>"transparent"</span><span class='op'>)</span>, <span class='co'># bg of the panel</span>
    plot.background <span class='op'>=</span> <span class='fu'>element_rect</span><span class='op'>(</span>fill <span class='op'>=</span> <span class='st'>"transparent"</span>, color <span class='op'>=</span> <span class='cn'>NA</span><span class='op'>)</span><span class='op'>)</span><span class='op'>+</span>
  <span class='fu'>scale_color_gradient</span><span class='op'>(</span>low <span class='op'>=</span> <span class='st'>"darkred"</span>, high <span class='op'>=</span> <span class='st'>"red"</span><span class='op'>)</span>

<span class='va'>data</span><span class='op'>$</span><span class='va'>time_1min</span><span class='op'>&lt;-</span><span class='fu'>str_replace_all</span><span class='op'>(</span><span class='va'>data</span><span class='op'>$</span><span class='va'>time_1min</span>,<span class='st'>"2014-01-23 "</span>,<span class='st'>""</span><span class='op'>)</span>


<span class='co'># data$time=ymd_hms(data$time_1min)</span>
<span class='co'># </span>
<span class='co'># p3&lt;-data %&gt;% </span>
<span class='co'>#   filter(str_detect(message,"fire|explosion|dolpin")) %&gt;% </span>
<span class='co'>#   group_by(time) %&gt;% </span>
<span class='co'>#   count() %&gt;%</span>
<span class='co'>#   ungroup() %&gt;% </span>
<span class='co'>#   ggplot(aes(x=time))+</span>
<span class='co'>#   geom_bar(aes(y=n), stat = "identity",fill = "black")+</span>
<span class='co'>#   theme(axis.title.y=element_blank(),</span>
<span class='co'>#         axis.ticks.y=element_blank(),</span>
<span class='co'>#         axis.text.y=element_blank(),</span>
<span class='co'>#         axis.title.x=element_blank(),</span>
<span class='co'>#         panel.background = element_rect(fill = "transparent"),</span>
<span class='co'>#         axis.ticks.x=element_blank(),</span>
<span class='co'>#         axis.text.x = element_text(angle = 90, hjust = 1))+</span>
<span class='co'>#         ggtitle("Tweets Trend Related to Dolphin Apartment")</span>



<span class='va'>data</span><span class='op'>$</span><span class='va'>time</span><span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/cut.html'>cut</a></span><span class='op'>(</span><span class='va'>data</span><span class='op'>$</span><span class='va'>timestamp</span>, breaks<span class='op'>=</span><span class='st'>"1 min"</span><span class='op'>)</span>
<span class='va'>data</span><span class='op'>$</span><span class='va'>time</span> <span class='op'>=</span><span class='fu'>ymd_hms</span><span class='op'>(</span><span class='va'>data</span><span class='op'>$</span><span class='va'>time</span><span class='op'>)</span>

<span class='va'>p3</span><span class='op'>&lt;-</span><span class='va'>data</span> <span class='op'>%&gt;%</span> 
  <span class='fu'><a href='https://rdrr.io/r/stats/filter.html'>filter</a></span><span class='op'>(</span><span class='fu'>str_detect</span><span class='op'>(</span><span class='va'>message</span>,<span class='st'>"fire|explosion|dolpin"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>group_by</span><span class='op'>(</span><span class='va'>time</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>count</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>ungroup</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>ggplot</span><span class='op'>(</span><span class='fu'>aes</span><span class='op'>(</span>x<span class='op'>=</span><span class='va'>time</span><span class='op'>)</span><span class='op'>)</span><span class='op'>+</span>
  <span class='fu'>geom_bar</span><span class='op'>(</span><span class='fu'>aes</span><span class='op'>(</span>y<span class='op'>=</span><span class='va'>n</span><span class='op'>)</span>, stat <span class='op'>=</span> <span class='st'>"identity"</span>,fill <span class='op'>=</span> <span class='st'>"black"</span><span class='op'>)</span><span class='op'>+</span>
  <span class='fu'>theme</span><span class='op'>(</span>axis.text.x <span class='op'>=</span> <span class='fu'>element_text</span><span class='op'>(</span>angle <span class='op'>=</span> <span class='fl'>90</span>, hjust <span class='op'>=</span> <span class='fl'>1</span><span class='op'>)</span><span class='op'>)</span><span class='op'>+</span>
        <span class='fu'>ggtitle</span><span class='op'>(</span><span class='st'>"Tweets Trend Related to Dolphin Apartment"</span><span class='op'>)</span>


<span class='co'># Move to a new page</span>
<span class='fu'>grid.newpage</span><span class='op'>(</span><span class='op'>)</span>
<span class='co'># Create layout : nrow = 2, ncol = 2</span>
<span class='fu'>pushViewport</span><span class='op'>(</span><span class='fu'>viewport</span><span class='op'>(</span>layout <span class='op'>=</span> <span class='fu'>grid.layout</span><span class='op'>(</span><span class='fl'>2</span>, <span class='fl'>2</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
<span class='co'># A helper function to define a region on the layout</span>

<span class='va'>define_region</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>row</span>, <span class='va'>col</span><span class='op'>)</span><span class='op'>{</span>
  <span class='fu'>viewport</span><span class='op'>(</span>layout.pos.row <span class='op'>=</span> <span class='va'>row</span>, layout.pos.col <span class='op'>=</span> <span class='va'>col</span><span class='op'>)</span>
<span class='op'>}</span> 
<span class='co'># Arrange the plots</span>
<span class='fu'><a href='https://rdrr.io/r/base/print.html'>print</a></span><span class='op'>(</span><span class='va'>p1</span>, vp<span class='op'>=</span><span class='fu'>define_region</span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>1</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/print.html'>print</a></span><span class='op'>(</span><span class='va'>p2</span>, vp <span class='op'>=</span> <span class='fu'>define_region</span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>2</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/print.html'>print</a></span><span class='op'>(</span><span class='va'>p3</span>, vp <span class='op'>=</span> <span class='fu'>define_region</span><span class='op'>(</span><span class='fl'>2</span>, <span class='fl'>1</span><span class='op'>:</span><span class='fl'>2</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<p><img src="Question_Answer_files/figure-html5/unnamed-chunk-15-1.png" width="624" /></p>
</div>
<p><strong>If its real time, I will arrange the trajectory of the team according to the status of the event and its location</strong></p>
<p>In the real time events, I will monitor the tweets/retweerts trend, risk level and location-stamped posts.</p>
<p>At 19:20:00 pm, hennyhenhendrix posted a location-stamped post -Some moron in a black van just hit my car! then, in 2 minutes, all call center alramed - ALL UNITS BROADCAST-FELONY HIT &amp; RUN-BLACK VAN/PARTIAL PLATE #L829 which brings the event to very high attention. The team should be sent to the location of 547 N. Schaber Ave as reporeted by call center. And then the team should follow the trajectory of the location based by call center reporting the same ,</p>
<p>Egeou Ave / Ipsilantou Ave - N. Hacia St / N. Brada St -N. Antoniadou St / N. Estos St, Profitou Ilia St / Egeou Ave, and N. Limnou St / N. Achilleos St ( 7:38:22 pm)</p>
<p>At the same time, it is suggested that authority keep monitoring the location-stamped post in the community to keep tracking the black van. Users like truccotrucco and sofitees were key reporters with loacted near to N. Limnou St / N. Achilleos St reporting the hostage regarding black van. The team should follow their location and provide first aid at their location.</p>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>Show code</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>abila</span><span class='op'>&lt;-</span><span class='fu'>st_read</span><span class='op'>(</span><span class='st'>'data/MC3/Geospatial/Abila.shp'</span>,quiet<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span>


<span class='va'>df_ccdata</span><span class='op'>&lt;-</span><span class='va'>data</span> <span class='op'>%&gt;%</span> 
  <span class='fu'><a href='https://rdrr.io/r/stats/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>type</span><span class='op'>==</span><span class='st'>"ccdata"</span>,<span class='va'>location</span><span class='op'>!=</span><span class='st'>"N/A"</span>,<span class='fu'>str_detect</span><span class='op'>(</span><span class='va'>message</span>,<span class='st'>"POLICE|FIRE|CRIME|SUSPICIOUS|VAN"</span><span class='op'>)</span><span class='op'>)</span>


<span class='va'>df_ccdata</span><span class='op'>&lt;-</span><span class='fu'><a href='https://rdrr.io/r/base/subset.html'>subset</a></span><span class='op'>(</span><span class='va'>df_ccdata</span>,select<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"type"</span>,<span class='st'>"message"</span>,<span class='st'>"location"</span>,<span class='st'>"timestamp"</span><span class='op'>)</span><span class='op'>)</span> 

<span class='va'>df_ccdata</span><span class='op'>&lt;-</span><span class='va'>df_ccdata</span> <span class='op'>%&gt;%</span><span class='fu'>separate</span><span class='op'>(</span><span class='va'>location</span>,<span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"street1"</span>,<span class='st'>"street2"</span><span class='op'>)</span>,sep<span class='op'>=</span><span class='st'>"(/)"</span>,convert<span class='op'>=</span><span class='cn'>T</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>drop_na</span><span class='op'>(</span><span class='va'>street2</span><span class='op'>)</span>

<span class='va'>df_ccdata</span><span class='op'>&lt;-</span><span class='va'>df_ccdata</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>separate</span><span class='op'>(</span><span class='va'>street1</span>,<span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"street1_D"</span>,<span class='st'>"street1"</span><span class='op'>)</span>,sep<span class='op'>=</span><span class='st'>"\\."</span>,convert<span class='op'>=</span><span class='cn'>F</span><span class='op'>)</span>


<span class='va'>df_ccdata</span><span class='op'>&lt;-</span><span class='va'>df_ccdata</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>separate</span><span class='op'>(</span><span class='va'>street2</span>,<span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"street2_D"</span>,<span class='st'>"street2"</span><span class='op'>)</span>,sep<span class='op'>=</span><span class='st'>"\\."</span>,convert<span class='op'>=</span><span class='cn'>F</span><span class='op'>)</span>

<span class='va'>df_ccdata</span><span class='op'>$</span><span class='va'>street1</span><span class='op'>&lt;-</span><span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/NA.html'>is.na</a></span><span class='op'>(</span><span class='va'>df_ccdata</span><span class='op'>$</span><span class='va'>street1</span><span class='op'>)</span>,<span class='va'>df_ccdata</span><span class='op'>$</span><span class='va'>street1_D</span>,<span class='va'>df_ccdata</span><span class='op'>$</span><span class='va'>street1</span><span class='op'>)</span>
<span class='va'>df_ccdata</span><span class='op'>$</span><span class='va'>street1_D</span><span class='op'>&lt;-</span><span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span><span class='op'>(</span><span class='va'>df_ccdata</span><span class='op'>$</span><span class='va'>street1</span><span class='op'>==</span><span class='va'>df_ccdata</span><span class='op'>$</span><span class='va'>street1_D</span>,<span class='cn'>NA</span>,<span class='va'>df_ccdata</span><span class='op'>$</span><span class='va'>street1_D</span><span class='op'>)</span>

<span class='va'>df_ccdata</span><span class='op'>$</span><span class='va'>street2</span><span class='op'>&lt;-</span><span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/NA.html'>is.na</a></span><span class='op'>(</span><span class='va'>df_ccdata</span><span class='op'>$</span><span class='va'>street2</span><span class='op'>)</span>,<span class='va'>df_ccdata</span><span class='op'>$</span><span class='va'>street2_D</span>,<span class='va'>df_ccdata</span><span class='op'>$</span><span class='va'>street2</span><span class='op'>)</span>
<span class='va'>df_ccdata</span><span class='op'>$</span><span class='va'>street2_D</span><span class='op'>&lt;-</span><span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span><span class='op'>(</span><span class='va'>df_ccdata</span><span class='op'>$</span><span class='va'>street2</span><span class='op'>==</span><span class='va'>df_ccdata</span><span class='op'>$</span><span class='va'>street2_D</span>,<span class='cn'>NA</span>,<span class='va'>df_ccdata</span><span class='op'>$</span><span class='va'>street2_D</span><span class='op'>)</span>


<span class='va'>df_ccdata</span><span class='op'>$</span><span class='va'>street1</span> <span class='op'>&lt;-</span> <span class='fu'>str_replace_all</span><span class='op'>(</span><span class='va'>df_ccdata</span><span class='op'>$</span><span class='va'>street1</span>,<span class='st'>" [St|Ave]"</span>,<span class='st'>""</span><span class='op'>)</span>
<span class='va'>df_ccdata</span><span class='op'>$</span><span class='va'>street1</span> <span class='op'>&lt;-</span> <span class='fu'>str_replace_all</span><span class='op'>(</span><span class='va'>df_ccdata</span><span class='op'>$</span><span class='va'>street1</span>,<span class='st'>" "</span>,<span class='st'>""</span><span class='op'>)</span>
<span class='va'>df_ccdata</span><span class='op'>$</span><span class='va'>street2</span> <span class='op'>&lt;-</span> <span class='fu'>str_replace_all</span><span class='op'>(</span><span class='va'>df_ccdata</span><span class='op'>$</span><span class='va'>street2</span>,<span class='st'>" [St|Ave]"</span>,<span class='st'>""</span><span class='op'>)</span>
<span class='va'>df_ccdata</span><span class='op'>$</span><span class='va'>street2</span> <span class='op'>&lt;-</span> <span class='fu'>str_replace_all</span><span class='op'>(</span><span class='va'>df_ccdata</span><span class='op'>$</span><span class='va'>street2</span>,<span class='st'>" "</span>,<span class='st'>""</span><span class='op'>)</span>

<span class='co'># Read Abila Map</span>
<span class='va'>abila</span><span class='op'>&lt;-</span><span class='fu'>st_read</span><span class='op'>(</span><span class='st'>'data/MC3/Geospatial/Abila.shp'</span>,quiet<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span>

<span class='va'>p</span> <span class='op'>=</span> <span class='fu'>npts</span><span class='op'>(</span><span class='va'>abila</span>, by_feature <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>
<span class='va'>abila</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>cbind</a></span><span class='op'>(</span><span class='va'>abila</span>, <span class='va'>p</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://rdrr.io/r/stats/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>p</span><span class='op'>&gt;</span><span class='fl'>1</span><span class='op'>)</span>
<span class='va'>abila</span><span class='op'>&lt;-</span><span class='va'>abila</span> <span class='op'>%&gt;%</span> <span class='fu'>mutate</span><span class='op'>(</span>geometry2<span class='op'>=</span><span class='fu'>st_touches</span><span class='op'>(</span><span class='va'>geometry</span><span class='op'>)</span><span class='op'>)</span>


<span class='va'>l1</span><span class='op'>&lt;-</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"184646017"</span>,<span class='st'>"184646189"</span><span class='op'>)</span>
<span class='va'>l11</span><span class='op'>&lt;-</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"184646189"</span>,<span class='st'>"184646726"</span><span class='op'>)</span>
<span class='va'>l2</span><span class='op'>&lt;-</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"184646726"</span>,<span class='st'>"184645566"</span><span class='op'>)</span>
<span class='va'>l3</span><span class='op'>&lt;-</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"184645566"</span>,<span class='st'>"184645397"</span><span class='op'>)</span>
<span class='va'>l4</span><span class='op'>&lt;-</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"184645397"</span>,<span class='st'>"184644393"</span><span class='op'>)</span>

<span class='va'>l5</span><span class='op'>&lt;-</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"184646017"</span>,<span class='st'>"184646189"</span>,<span class='st'>"184646726"</span>,<span class='st'>"184645566"</span>,<span class='st'>"184645397"</span>,<span class='st'>"184645397"</span>,<span class='st'>"184644393"</span><span class='op'>)</span>


<span class='va'>abila1</span><span class='op'>&lt;-</span><span class='va'>abila</span> <span class='op'>%&gt;%</span>
<span class='fu'><a href='https://rdrr.io/r/stats/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>TLID</span> <span class='op'>%in%</span> <span class='va'>l1</span><span class='op'>)</span>
<span class='va'>p</span><span class='op'>=</span> <span class='fu'>npts</span><span class='op'>(</span><span class='va'>abila1</span>, by_feature <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>
<span class='va'>abila1</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>cbind</a></span><span class='op'>(</span><span class='va'>abila1</span>, <span class='va'>p</span><span class='op'>)</span> <span class='op'>%&gt;%</span><span class='fu'><a href='https://rdrr.io/r/stats/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>p</span><span class='op'>&gt;</span><span class='fl'>1</span><span class='op'>)</span> 
<span class='va'>abila1</span><span class='op'>&lt;-</span><span class='va'>abila1</span><span class='op'>%&gt;%</span> 
<span class='fu'>mutate</span><span class='op'>(</span>geometry2<span class='op'>=</span><span class='fu'>st_touches</span><span class='op'>(</span><span class='va'>geometry</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>  
  <span class='fu'>mutate</span><span class='op'>(</span>long <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/unlist.html'>unlist</a></span><span class='op'>(</span><span class='fu'>map</span><span class='op'>(</span><span class='va'>geometry</span>,<span class='fl'>2</span><span class='op'>)</span><span class='op'>)</span>,
           lat <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/unlist.html'>unlist</a></span><span class='op'>(</span><span class='fu'>map</span><span class='op'>(</span><span class='va'>geometry</span>,<span class='fl'>3</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>

<span class='va'>abila11</span><span class='op'>&lt;-</span><span class='va'>abila</span> <span class='op'>%&gt;%</span>
<span class='fu'><a href='https://rdrr.io/r/stats/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>TLID</span> <span class='op'>%in%</span> <span class='va'>l11</span><span class='op'>)</span>
<span class='va'>p</span><span class='op'>=</span> <span class='fu'>npts</span><span class='op'>(</span><span class='va'>abila1</span>, by_feature <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>
<span class='va'>abila11</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>cbind</a></span><span class='op'>(</span><span class='va'>abila11</span>, <span class='va'>p</span><span class='op'>)</span> <span class='op'>%&gt;%</span><span class='fu'><a href='https://rdrr.io/r/stats/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>p</span><span class='op'>&gt;</span><span class='fl'>1</span><span class='op'>)</span> 
<span class='va'>abila11</span><span class='op'>&lt;-</span><span class='va'>abila11</span><span class='op'>%&gt;%</span> 
<span class='fu'>mutate</span><span class='op'>(</span>geometry2<span class='op'>=</span><span class='fu'>st_touches</span><span class='op'>(</span><span class='va'>geometry</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>  
  <span class='fu'>mutate</span><span class='op'>(</span>long <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/unlist.html'>unlist</a></span><span class='op'>(</span><span class='fu'>map</span><span class='op'>(</span><span class='va'>geometry</span>,<span class='fl'>2</span><span class='op'>)</span><span class='op'>)</span>,
           lat <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/unlist.html'>unlist</a></span><span class='op'>(</span><span class='fu'>map</span><span class='op'>(</span><span class='va'>geometry</span>,<span class='fl'>3</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>

<span class='va'>abila2</span><span class='op'>&lt;-</span><span class='va'>abila</span> <span class='op'>%&gt;%</span>
<span class='fu'><a href='https://rdrr.io/r/stats/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>TLID</span> <span class='op'>%in%</span> <span class='va'>l2</span><span class='op'>)</span>
<span class='va'>p</span><span class='op'>=</span> <span class='fu'>npts</span><span class='op'>(</span><span class='va'>abila2</span>, by_feature <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>
<span class='va'>abila2</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>cbind</a></span><span class='op'>(</span><span class='va'>abila2</span>, <span class='va'>p</span><span class='op'>)</span> <span class='op'>%&gt;%</span><span class='fu'><a href='https://rdrr.io/r/stats/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>p</span><span class='op'>&gt;</span><span class='fl'>1</span><span class='op'>)</span> 
<span class='va'>abila2</span><span class='op'>&lt;-</span><span class='va'>abila2</span><span class='op'>%&gt;%</span> 
<span class='fu'>mutate</span><span class='op'>(</span>geometry2<span class='op'>=</span><span class='fu'>st_touches</span><span class='op'>(</span><span class='va'>geometry</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>  
  <span class='fu'>mutate</span><span class='op'>(</span>long <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/unlist.html'>unlist</a></span><span class='op'>(</span><span class='fu'>map</span><span class='op'>(</span><span class='va'>geometry</span>,<span class='fl'>2</span><span class='op'>)</span><span class='op'>)</span>,
           lat <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/unlist.html'>unlist</a></span><span class='op'>(</span><span class='fu'>map</span><span class='op'>(</span><span class='va'>geometry</span>,<span class='fl'>3</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>

<span class='va'>abila3</span><span class='op'>&lt;-</span><span class='va'>abila</span> <span class='op'>%&gt;%</span>
<span class='fu'><a href='https://rdrr.io/r/stats/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>TLID</span> <span class='op'>%in%</span> <span class='va'>l3</span><span class='op'>)</span>
<span class='va'>p</span><span class='op'>=</span> <span class='fu'>npts</span><span class='op'>(</span><span class='va'>abila3</span>, by_feature <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>
<span class='va'>abila3</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>cbind</a></span><span class='op'>(</span><span class='va'>abila3</span>, <span class='va'>p</span><span class='op'>)</span> <span class='op'>%&gt;%</span><span class='fu'><a href='https://rdrr.io/r/stats/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>p</span><span class='op'>&gt;</span><span class='fl'>1</span><span class='op'>)</span> 
<span class='va'>abila3</span><span class='op'>&lt;-</span><span class='va'>abila3</span><span class='op'>%&gt;%</span> 
<span class='fu'>mutate</span><span class='op'>(</span>geometry2<span class='op'>=</span><span class='fu'>st_touches</span><span class='op'>(</span><span class='va'>geometry</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>  
  <span class='fu'>mutate</span><span class='op'>(</span>long <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/unlist.html'>unlist</a></span><span class='op'>(</span><span class='fu'>map</span><span class='op'>(</span><span class='va'>geometry</span>,<span class='fl'>2</span><span class='op'>)</span><span class='op'>)</span>,
           lat <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/unlist.html'>unlist</a></span><span class='op'>(</span><span class='fu'>map</span><span class='op'>(</span><span class='va'>geometry</span>,<span class='fl'>3</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>

<span class='va'>abila4</span><span class='op'>&lt;-</span><span class='va'>abila</span> <span class='op'>%&gt;%</span>
<span class='fu'><a href='https://rdrr.io/r/stats/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>TLID</span> <span class='op'>%in%</span> <span class='va'>l4</span><span class='op'>)</span>
<span class='va'>p</span><span class='op'>=</span> <span class='fu'>npts</span><span class='op'>(</span><span class='va'>abila4</span>, by_feature <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>
<span class='va'>abila4</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>cbind</a></span><span class='op'>(</span><span class='va'>abila4</span>, <span class='va'>p</span><span class='op'>)</span> <span class='op'>%&gt;%</span><span class='fu'><a href='https://rdrr.io/r/stats/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>p</span><span class='op'>&gt;</span><span class='fl'>1</span><span class='op'>)</span> 
<span class='va'>abila4</span><span class='op'>&lt;-</span><span class='va'>abila4</span><span class='op'>%&gt;%</span> 
<span class='fu'>mutate</span><span class='op'>(</span>geometry2<span class='op'>=</span><span class='fu'>st_touches</span><span class='op'>(</span><span class='va'>geometry</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>  
  <span class='fu'>mutate</span><span class='op'>(</span>long <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/unlist.html'>unlist</a></span><span class='op'>(</span><span class='fu'>map</span><span class='op'>(</span><span class='va'>geometry</span>,<span class='fl'>2</span><span class='op'>)</span><span class='op'>)</span>,
           lat <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/unlist.html'>unlist</a></span><span class='op'>(</span><span class='fu'>map</span><span class='op'>(</span><span class='va'>geometry</span>,<span class='fl'>3</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>

<span class='va'>abila5</span><span class='op'>&lt;-</span><span class='va'>abila</span> <span class='op'>%&gt;%</span>
<span class='fu'><a href='https://rdrr.io/r/stats/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>TLID</span> <span class='op'>%in%</span> <span class='va'>l5</span><span class='op'>)</span>
<span class='va'>p</span><span class='op'>=</span> <span class='fu'>npts</span><span class='op'>(</span><span class='va'>abila5</span>, by_feature <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>
<span class='va'>abila5</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>cbind</a></span><span class='op'>(</span><span class='va'>abila5</span>, <span class='va'>p</span><span class='op'>)</span> <span class='op'>%&gt;%</span><span class='fu'><a href='https://rdrr.io/r/stats/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>p</span><span class='op'>&gt;</span><span class='fl'>1</span><span class='op'>)</span> 
<span class='va'>abila5</span><span class='op'>&lt;-</span><span class='va'>abila5</span><span class='op'>%&gt;%</span> 
<span class='fu'>mutate</span><span class='op'>(</span>geometry2<span class='op'>=</span><span class='fu'>st_touches</span><span class='op'>(</span><span class='va'>geometry</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>  
  <span class='fu'>mutate</span><span class='op'>(</span>long <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/unlist.html'>unlist</a></span><span class='op'>(</span><span class='fu'>map</span><span class='op'>(</span><span class='va'>geometry</span>,<span class='fl'>2</span><span class='op'>)</span><span class='op'>)</span>,
           lat <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/unlist.html'>unlist</a></span><span class='op'>(</span><span class='fu'>map</span><span class='op'>(</span><span class='va'>geometry</span>,<span class='fl'>3</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>


<span class='va'>data_location</span> <span class='op'>&lt;-</span> <span class='va'>data</span> <span class='op'>%&gt;%</span> 
  <span class='fu'><a href='https://rdrr.io/r/stats/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>longitude</span><span class='op'>!=</span><span class='st'>""</span>,<span class='fu'>str_detect</span><span class='op'>(</span><span class='va'>message</span>,<span class='st'>"hit|van|shoot|driver"</span><span class='op'>)</span> <span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>add_count</span><span class='op'>(</span><span class='va'>longitude</span>,<span class='va'>latitude</span>,<span class='va'>author</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>rename</span><span class='op'>(</span>Witness<span class='op'>=</span><span class='va'>author</span><span class='op'>)</span>


<span class='va'>abila5</span><span class='op'>$</span><span class='va'>label</span><span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"van observation"</span>,<span class='st'>"van observation"</span>,<span class='st'>"van observation"</span>,<span class='st'>"fire"</span>,<span class='st'>"car/bike hit"</span>,<span class='st'>"van observation"</span><span class='op'>)</span>


<span class='fu'>ggplot</span><span class='op'>(</span><span class='op'>)</span><span class='op'>+</span>
  <span class='fu'>geom_sf</span><span class='op'>(</span>data<span class='op'>=</span><span class='va'>abila</span>,size<span class='op'>=</span><span class='fl'>1</span>,color<span class='op'>=</span><span class='st'>"grey"</span>,fill<span class='op'>=</span><span class='st'>"cyan1"</span><span class='op'>)</span><span class='op'>+</span>
  <span class='fu'>ggtitle</span><span class='op'>(</span><span class='st'>"Abila"</span><span class='op'>)</span><span class='op'>+</span>
  <span class='fu'>geom_point</span><span class='op'>(</span>data <span class='op'>=</span> <span class='va'>data_location</span>, <span class='fu'>aes</span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>longitude</span>,y<span class='op'>=</span><span class='va'>latitude</span>,color<span class='op'>=</span><span class='va'>Witness</span><span class='op'>)</span>,size<span class='op'>=</span><span class='fl'>3</span><span class='op'>)</span><span class='op'>+</span>
  <span class='fu'>geom_point</span><span class='op'>(</span>data <span class='op'>=</span> <span class='va'>abila5</span>,mapping <span class='op'>=</span> <span class='fu'>aes</span><span class='op'>(</span>x<span class='op'>=</span><span class='va'>long</span>,y<span class='op'>=</span><span class='va'>lat</span>,label<span class='op'>=</span><span class='va'>label</span><span class='op'>)</span>,color<span class='op'>=</span><span class='st'>"red"</span>,size<span class='op'>=</span><span class='fl'>3</span><span class='op'>)</span><span class='op'>+</span>
  <span class='fu'>geom_text</span><span class='op'>(</span>data <span class='op'>=</span> <span class='va'>abila5</span>,mapping <span class='op'>=</span> <span class='fu'>aes</span><span class='op'>(</span>x<span class='op'>=</span><span class='va'>long</span>,y<span class='op'>=</span><span class='va'>lat</span>,label<span class='op'>=</span><span class='va'>label</span><span class='op'>)</span>,color<span class='op'>=</span><span class='st'>"red"</span>,size<span class='op'>=</span><span class='fl'>3</span>,vjust<span class='op'>=</span><span class='fl'>2</span>,hjust<span class='op'>=</span><span class='op'>-</span><span class='fl'>0.1</span><span class='op'>)</span><span class='op'>+</span>
  <span class='fu'>theme</span><span class='op'>(</span>axis.title.y<span class='op'>=</span><span class='fu'>element_blank</span><span class='op'>(</span><span class='op'>)</span>,
        axis.ticks.y<span class='op'>=</span><span class='fu'>element_blank</span><span class='op'>(</span><span class='op'>)</span>,
        axis.text.y<span class='op'>=</span><span class='fu'>element_blank</span><span class='op'>(</span><span class='op'>)</span>,
        axis.title.x<span class='op'>=</span><span class='fu'>element_blank</span><span class='op'>(</span><span class='op'>)</span>,
        panel.background <span class='op'>=</span> <span class='fu'>element_rect</span><span class='op'>(</span>fill <span class='op'>=</span> <span class='st'>"transparent"</span><span class='op'>)</span>,
        axis.text.x<span class='op'>=</span><span class='fu'>element_blank</span><span class='op'>(</span><span class='op'>)</span>,
        axis.ticks.x<span class='op'>=</span><span class='fu'>element_blank</span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span><span class='op'>+</span>
        <span class='fu'>ggtitle</span><span class='op'>(</span><span class='st'>"Located Ccdata and Microblogs for Real-time Tracking"</span><span class='op'>)</span><span class='op'>+</span>
  <span class='fu'>geom_text</span><span class='op'>(</span><span class='op'>)</span><span class='op'>+</span>
  <span class='fu'>geom_line</span><span class='op'>(</span>data <span class='op'>=</span> <span class='va'>abila1</span>,mapping <span class='op'>=</span> <span class='fu'>aes</span><span class='op'>(</span>x<span class='op'>=</span><span class='va'>long</span>,y<span class='op'>=</span><span class='va'>lat</span><span class='op'>)</span>,color<span class='op'>=</span><span class='st'>"red"</span>,size<span class='op'>=</span><span class='fl'>1</span>,linetype <span class='op'>=</span> <span class='st'>"dashed"</span><span class='op'>)</span><span class='op'>+</span>
  <span class='co'>#geom_text(aes(x = 0, y = 0, label = "AAPL"))+</span>
  <span class='fu'>geom_line</span><span class='op'>(</span>data <span class='op'>=</span> <span class='va'>abila11</span>,mapping <span class='op'>=</span> <span class='fu'>aes</span><span class='op'>(</span>x<span class='op'>=</span><span class='va'>long</span>,y<span class='op'>=</span><span class='va'>lat</span><span class='op'>)</span>,color<span class='op'>=</span><span class='st'>"red"</span>,size<span class='op'>=</span><span class='fl'>1</span>,linetype <span class='op'>=</span> <span class='st'>"dashed"</span><span class='op'>)</span><span class='op'>+</span>
  <span class='fu'>geom_line</span><span class='op'>(</span>data <span class='op'>=</span> <span class='va'>abila2</span>,mapping <span class='op'>=</span> <span class='fu'>aes</span><span class='op'>(</span>x<span class='op'>=</span><span class='va'>long</span>,y<span class='op'>=</span><span class='va'>lat</span><span class='op'>)</span>,color<span class='op'>=</span><span class='st'>"red"</span>,size<span class='op'>=</span><span class='fl'>1</span>,linetype <span class='op'>=</span> <span class='st'>"dashed"</span><span class='op'>)</span><span class='op'>+</span>
  <span class='fu'>geom_line</span><span class='op'>(</span>data <span class='op'>=</span> <span class='va'>abila3</span>,mapping <span class='op'>=</span> <span class='fu'>aes</span><span class='op'>(</span>x<span class='op'>=</span><span class='va'>long</span>,y<span class='op'>=</span><span class='va'>lat</span><span class='op'>)</span>,color<span class='op'>=</span><span class='st'>"red"</span>,size<span class='op'>=</span><span class='fl'>1</span>,linetype <span class='op'>=</span> <span class='st'>"dashed"</span><span class='op'>)</span><span class='op'>+</span>
  <span class='fu'>geom_line</span><span class='op'>(</span>data <span class='op'>=</span> <span class='va'>abila4</span>,mapping <span class='op'>=</span> <span class='fu'>aes</span><span class='op'>(</span>x<span class='op'>=</span><span class='va'>long</span>,y<span class='op'>=</span><span class='va'>lat</span><span class='op'>)</span>,color<span class='op'>=</span><span class='st'>"red"</span>,size<span class='op'>=</span><span class='fl'>1</span>,linetype <span class='op'>=</span> <span class='st'>"dashed"</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<p><img src="Question_Answer_files/figure-html5/unnamed-chunk-16-1.png" width="624" /></p>
</div>
<div class="layout-chunk" data-layout="l-body">
<details>
<summary>Show code</summary>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>data_location</span><span class='op'>$</span><span class='va'>timestamp</span><span class='op'>&lt;-</span><span class='fu'><a href='https://rdrr.io/r/base/format.html'>format</a></span><span class='op'>(</span><span class='va'>data_location</span><span class='op'>$</span><span class='va'>timestamp</span>, format <span class='op'>=</span> <span class='st'>"%H:%M:%S"</span><span class='op'>)</span>

<span class='fu'>DT</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/DT/man/datatable.html'>datatable</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/subset.html'>subset</a></span><span class='op'>(</span><span class='va'>data_location</span>,select<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>timestamp</span>,<span class='va'>Witness</span>,<span class='va'>message</span>,<span class='va'>longitude</span>,<span class='va'>latitude</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
</details>
<div id="htmlwidget-f3034b00fa8ee5369015" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-f3034b00fa8ee5369015">{"x":{"filter":"none","data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29"],["19:20:00","19:20:00","19:21:01","19:21:38","19:22:00","19:39:40","19:40:00","19:40:41","19:41:03","19:41:33","19:42:28","19:43:11","19:43:39","19:44:23","19:44:38","19:45:11","19:46:00","19:50:00","19:51:13","19:55:59","19:58:13","20:11:21","21:00:04","21:00:04","21:04:05","21:13:00","21:14:01","21:17:11","21:21:11"],["hennyhenhendrix","brewvebeenserved","brewvebeenserved","brewvebeenserved","trapanitweets","trapanitweets","truccotrucco","truccotrucco","truccotrucco","truccotrucco","truccotrucco","truccotrucco","truccotrucco","truccotrucco","truccotrucco","truccotrucco","truccotrucco","truccotrucco","truccotrucco","truccotrucco","truccotrucco","hennyhenhendrix","truccotrucco","sofitees","truccotrucco","truccotrucco","truccotrucco","sofitees","truccotrucco"],["Some moron in a black van just hit my car!","WOW! Crazy driver! Hopefully everyone is ok!","Oh no!! That crazy driver hit a guy on a bike outside our shop!!","FREE COFFEE to anyone who caught the license plate of that black van! #jerkdrivers","OMG!!!!!!! Some derp in a?balck?van just?hit a guy on a bike!!!!!","Except for that derp who hit henri.","wow some crazy black van just got pulled over in the parking lot - dinner &amp; a show!","OMG there shooting there shooting!","what is happening? they r right out front shooting","why didnt i stay at the rally? im trapped in here the van is right outsdie the door","havent heard any more shots pls no more #shooting","who shoots a cop? who are these maniacs?!?!","im hearing more sirens i think i can get a view outside #shooting","looks like there are 3 cop cars and the black van two people in the front of van #shooting","putting my head back down #shooting","i think were trapped in here #gelatogalore #shooting","more cops have arrived someone just saw #shooting","ambulance has arrived hopefully getting the cop to the hospital fast praying hes OK #shooting","#APD are heroes! #shooting","i think the swat team has arrived hopefully stand off ends soon #shooting #standoff","guy in the van keeps yeelling at cops cant hear him but looks mad #standoff","they seemed really interested in where that van came from","what is this guy doing? just give up and now hes back in the van #standoff #gelatogalore","crazy guy is back in the van - what is going on?","looks like therye still fighting in the van really animated #standoff","someones out of the van! is it over?","other guy is out of the van! its over theyre giving up! #standoff","i think there giving up 2 people hands up got out of the van guy &amp; girl","cant belive it a peaceful ending after a shootout! #stillshaking"],[24.892,24.901,24.901,24.901,24.901,24.901,24.856,24.856,24.856,24.856,24.856,24.856,24.856,24.856,24.856,24.856,24.856,24.856,24.856,24.856,24.856,24.892,24.856,24.857,24.856,24.856,24.856,24.857,24.856],[36.057,36.054,36.054,36.054,36.054,36.054,36.059,36.059,36.059,36.059,36.059,36.059,36.059,36.059,36.059,36.059,36.059,36.059,36.059,36.059,36.059,36.057,36.059,36.059,36.059,36.059,36.059,36.059,36.059]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>timestamp<\/th>\n      <th>Witness<\/th>\n      <th>message<\/th>\n      <th>longitude<\/th>\n      <th>latitude<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[4,5]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
<p>#Reference</p>
<p>Junghoon Chae, Dennis Thom, Yun Jang, SungYe Kim, Thomas Ertl, David S. Ebert, Public behavior response analysis in disaster events utilizing visual analytics of microblog data,Computers &amp; Graphics,Volume 38,2014,Pages 51-60,ISSN 0097-8493,<a href="https://doi.org/10.1016/j.cag.2013.10.008" class="uri">https://doi.org/10.1016/j.cag.2013.10.008</a>.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r distill-force-highlighting-css"><code class="sourceCode r"></code></pre></div>
<!--radix_placeholder_article_footer-->
<!--/radix_placeholder_article_footer-->
</div>

<div class="d-appendix">
</div>


<!--radix_placeholder_site_after_body-->
<!--/radix_placeholder_site_after_body-->
<!--radix_placeholder_appendices-->
<div class="appendix-bottom"></div>
<!--/radix_placeholder_appendices-->
<!--radix_placeholder_navigation_after_body-->
<!--/radix_placeholder_navigation_after_body-->

</body>

</html>
